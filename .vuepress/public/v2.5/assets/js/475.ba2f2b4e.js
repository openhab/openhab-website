(window.webpackJsonp=window.webpackJsonp||[]).push([[475],{749:function(t,e,s){"use strict";s.r(e);var a=s(0),n=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),s("AddonLogo"),t._v(" "),s("p",[t._v("Transforms a JSON structure on basis of the "),s("a",{attrs:{href:"https://github.com/jayway/JsonPath#jayway-jsonpath",target:"_blank",rel:"noopener noreferrer"}},[t._v("JsonPath"),s("OutboundLink")],1),t._v(" expression to an JSON containing the requested data.")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),s("p",[t._v("Given the JSON")]),t._v(" "),t._m(3),t._m(4),t._v(" "),t._m(5),t._m(6),t._v(" "),t._m(7),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._m(11),t._v(" "),t._m(12),s("p",[t._v("Now the resulting Number can also be used in the label to "),s("a",{attrs:{href:"https://docs.openhab.org/configuration/sitemaps.html#label-and-value-colors",target:"_blank",rel:"noopener noreferrer"}},[t._v("change the color"),s("OutboundLink")],1),t._v(" or in a rule as value to compare.")]),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._m(18),t._v(" "),s("p",[t._v("Please note: This profile is a one-way transformation, i.e. only values from a device towards the item are changed, the other direction is left untouched.")]),t._v(" "),t._m(19),t._v(" "),s("ul",[s("li",[t._v("An extended "),s("a",{attrs:{href:"https://www.w3schools.com/js/js_json_intro.asp",target:"_blank",rel:"noopener noreferrer"}},[t._v("introduction"),s("OutboundLink")],1),t._v(" can be found at W3School.")]),t._v(" "),s("li",[t._v("As JsonPath transformation is based on "),s("a",{attrs:{href:"https://github.com/json-path/JsonPath",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jayway"),s("OutboundLink")],1),t._v(" using a "),s("a",{attrs:{href:"https://jsonpath.herokuapp.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("online validator"),s("OutboundLink")],1),t._v(" which also uses Jaway will give most similar results.")])]),t._v(" "),s("DocPreviousVersions"),t._v(" "),s("EditPageLink")],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"jsonpath-transformation-service"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jsonpath-transformation-service","aria-hidden":"true"}},[this._v("#")]),this._v(" JsonPath Transformation Service")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"examples"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#examples","aria-hidden":"true"}},[this._v("#")]),this._v(" Examples")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"basic-example"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#basic-example","aria-hidden":"true"}},[this._v("#")]),this._v(" Basic Example")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('[{ "device": { "location": "Outside", "status": { "temperature": 23.2 }}}]\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("the JsonPath expression "),e("code",[this._v("$.device.location")]),this._v(" exstracts the string instead a valid JSON "),e("code",[this._v('[ "Outside" ]')]),this._v(", see "),e("a",{attrs:{href:"#differences-to-standard-jsonpath"}},[this._v("differences")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("Outside\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("the JsonPath expression "),e("code",[this._v("$.device.status.temperature")]),this._v(" exstracts the number instead a valid JSON "),e("code",[this._v("[ 23.2 ]")]),this._v(", see "),e("a",{attrs:{href:"#differences-to-standard-jsonpath"}},[this._v("differences")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("23.2\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"in-setup"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#in-setup","aria-hidden":"true"}},[this._v("#")]),this._v(" In Setup")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("Item")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-csv extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dsl"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Temperature_json")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Temperature [JSONPATH($.device.status.temperature):%s °C]"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Number")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Temperature")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Temperature [%.1f °C]"')]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("Rule")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-rules"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("rule")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Convert JSON to Item Type Number"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Item")]),t._v(" Temperature_json "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("changed")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// use the transformation service to retrieve the value")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" newValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("transform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"JSONPATH"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"$.device.status.temperature"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-name"}},[t._v("Temperature_json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// post the new value to the Number Item")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function-name"}},[t._v("Temperature")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("postUpdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" newValue "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"differences-to-standard-jsonpath"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#differences-to-standard-jsonpath","aria-hidden":"true"}},[this._v("#")]),this._v(" Differences to standard JsonPath")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("Compared to standard JSON the transformation it returns evaluated values when a single alement is retrieved from the query.\nMeans it does not return a valid JSON "),s("code",[t._v("[ 23.2 ]")]),t._v(" but "),s("code",[t._v("23.2")]),t._v(", "),s("code",[t._v('[ "Outside" ]')]),t._v(" but "),s("code",[t._v("Outside")]),t._v(".\nThis makes it possible to use it in labels or output channel of things and get Numbers or Strings instead of JSON arrays.\nA query which returns multiple elements as list is not supported.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"usage-as-a-profile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#usage-as-a-profile","aria-hidden":"true"}},[this._v("#")]),this._v(" Usage as a Profile")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("The functionality of this "),s("code",[t._v("TransformationService")]),t._v(" can be used in a "),s("code",[t._v("Profile")]),t._v(" on an "),s("code",[t._v("ItemChannelLink")]),t._v(" too.\nTo do so, it can be configured in the "),s("code",[t._v(".items")]),t._v(" file as follows:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("itemName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" channel"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<channelUID>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("profile"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"transform:JSONPATH"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" function"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<jsonPath>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sourceFormat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<valueFormat>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("The JSONPath expression to be used has to be set in the "),s("code",[t._v("function")]),t._v(" parameter.\nThe parameter "),s("code",[t._v("sourceFormat")]),t._v(" is optional and can be used to format the input value "),s("strong",[t._v("before")]),t._v(" the transformation, i.e. "),s("code",[t._v("%.3f")]),t._v(".\nIf omitted the default is "),s("code",[t._v("%s")]),t._v(", so the input value will be put into the transformation without any format changes.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"further-reading"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#further-reading","aria-hidden":"true"}},[this._v("#")]),this._v(" Further Reading")])}],!1,null,null,null);e.default=n.exports}}]);