(window.webpackJsonp=window.webpackJsonp||[]).push([[546],{531:function(t,e,s){"use strict";s.r(e);var a=s(0),r=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),s("p",[t._v("openHAB has mainly two ways to be accessed:")]),t._v(" "),s("ol",[s("li",[t._v("Through the command line console, which is done through SSH and thus always authenticated and encrypted. You will find all details about this in the "),s("router-link",{attrs:{to:"/docs/administration/console.html"}},[t._v("Console documentation")]),t._v(".")],1),t._v(" "),s("li",[t._v("Through HTTP(S), which we will look at in the following.")])]),t._v(" "),s("p"),t._m(1),s("p"),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),s("p",[t._v("openHAB has a built-in webserver, which listens on port 8080 for HTTP and 8443 for HTTPS requests.\nIn general, it is advised to use HTTPS communication over HTTP.")]),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),s("p",[t._v("openHAB does not (yet) support restricting access through HTTP(S) for certain users - there is no authentication in place, nor is there a limitation of functionality or information that different users can access.")]),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),s("p",[t._v("will e.g. only allow requests through the local loopback interface.")]),t._v(" "),t._m(11),t._v(" "),s("p",[t._v("Clearly, having remote access to your openHAB instance is something most users would not want to miss.\nThere are different options to do so.")]),t._v(" "),t._m(12),t._v(" "),s("p",[t._v("The most secure option is probably to create a VPN connection to your home network.\nDoing so will allow you to access your openHAB instance in the same way as if you were at home.\nThere are many different solutions for VPN, so we cannot give any specific advice here, what to use and how to set in up.")]),t._v(" "),t._m(13),t._v(" "),s("p",[t._v("You can use an "),s("a",{attrs:{href:"https://github.com/openhab/openhab-cloud/blob/master/README.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("openHAB Cloud"),s("OutboundLink")],1),t._v(" instance to which openHAB  creates a tunnel connection and which forwards all requests through this tunnel.\nopenHAB will see these incoming requests as originating from the local loopback interface.")]),t._v(" "),s("p",[t._v("The simplest way to get hold of such an openHAB Cloud is to register an account at "),s("a",{attrs:{href:"http://www.myopenhab.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("myopenHAB.org"),s("OutboundLink")],1),t._v(", which is operated by the "),s("a",{attrs:{href:"https://www.openhabfoundation.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("openHAB Foundation"),s("OutboundLink")],1),t._v(".")]),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),s("p",[t._v("The good news is that "),s("a",{attrs:{href:"openhabian"}},[t._v("openHABian")]),t._v(" already offers the possibility to activate a preconfigured NGINX reverse proxy, which includes setting up authentication and a valid "),s("a",{attrs:{href:"https://letsencrypt.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("Let's Encrypt"),s("OutboundLink")],1),t._v(" certificate.")]),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),s("p",[t._v("These are the steps required to use "),s("a",{attrs:{href:"https://nginx.org",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("NGINX")]),s("OutboundLink")],1),t._v(", a lightweight HTTP server, although you can use "),s("strong",[t._v("Apache HTTP")]),t._v(" server or any other HTTP server which supports reverse proxying.")]),t._v(" "),t._m(20),t._v(" "),s("p",[t._v("NGINX runs as a service in most Linux distributions, installation should be as simple as:")]),t._v(" "),t._m(21),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),s("p",[t._v("It is also recommended to name the file to something relevant to what it's doing, if you already have a default file in place, then you can rename it via:")]),t._v(" "),t._m(27),t._m(28),t._v(" "),t._m(29),t._v(" "),t._m(30),s("p",[t._v("If you see that the test is successful, you can restart the NGINX service with...")]),t._v(" "),t._m(31),t._m(32),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),t._m(39),t._v(" "),t._m(40),s("p",[t._v("You will receive a prompt to create a password for this username, once finished the file will be created.\nYou're then free to reference the file to NGINX.")]),t._v(" "),t._m(41),t._v(" "),t._m(42),t._v(" "),t._m(43),t._m(44),t._v(" "),t._m(45),t._v(" "),t._m(46),t._v(" "),t._m(47),s("p",[t._v("and to delete an existing user:")]),t._v(" "),t._m(48),t._m(49),t._v(" "),t._m(50),t._v(" "),t._m(51),t._v(" "),t._m(52),t._m(53),t._v(" "),t._m(54),t._v(" "),s("p",[t._v("To generate a trusted certificate, you need to own a domain. To acquire your own domain, you can use one of the following methods:")]),t._v(" "),s("table",[t._m(55),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("Purchasing a domain name")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("a",{attrs:{href:"http://www.godaddy.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("GoDaddy"),s("OutboundLink")],1),t._v(", "),s("a",{attrs:{href:"http://www.namecheap.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("Namecheap"),s("OutboundLink")],1),t._v(", "),s("a",{attrs:{href:"http://www.enom.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("Enom"),s("OutboundLink")],1),t._v(", "),s("a",{attrs:{href:"http://www.register.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("Register"),s("OutboundLink")],1)]),t._v(" "),t._m(56)]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("Obtaining a free domain")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("a",{attrs:{href:"http://www.freenom.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("FreeNom"),s("OutboundLink")],1)]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Setup is the same as above.")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v('Using a "Dynamic DNS" sevice')]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("a",{attrs:{href:"http://www.noip.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("No-IP"),s("OutboundLink")],1),t._v(", "),s("a",{attrs:{href:"http://www.dyn.com/dns",target:"_blank",rel:"noopener noreferrer"}},[t._v("Dyn"),s("OutboundLink")],1)]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Uses a client to automatically update your IP to a domain of you choice, some Dynamic DNS services offer a free domain too.")])])])]),t._v(" "),t._m(57),t._v(" "),s("p",[t._v("Encrypting the communication between client and the server is important because it protects against eavesdropping and possible forgery.\nThe following options are available depending if you have a valid domain:")]),t._v(" "),t._m(58),t._v(" "),t._m(59),t._v(" "),s("p",[t._v("OpenSSL is also packaged for most Linux distributions, installing it should be as simple as:")]),t._v(" "),t._m(60),s("p",[t._v("Once complete, you need to create a directory where our certificates can be placed:")]),t._v(" "),t._m(61),s("p",[t._v("Now OpenSSL can be told to generate a 2048 bit long RSA key and a certificate that is valid for a year:")]),t._v(" "),t._m(62),t._m(63),t._v(" "),t._m(64),t._v(" "),t._m(65),t._v(" "),t._m(66),t._m(67),t._v(" "),t._m(68),t._v(" "),s("p",[t._v("Let's Encrypt is a service that allows anyone with a valid domain to automatically generate a trusted certificate, these certificates are usually accepted by a browser without any warnings.")]),t._v(" "),t._m(69),t._v(" "),t._m(70),t._v(" "),t._m(71),t._v(" "),t._m(72),t._m(73),t._v(" "),t._m(74),t._m(75),t._v(" "),s("p",[t._v("Certbot is a tool which simplifies the process of obtaining secure certificates.\nThe tool may not be packaged for some Linux distributions so installation instructions may vary, check out "),s("a",{attrs:{href:"https://certbot.eff.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("their website"),s("OutboundLink")],1),t._v(" and follow the instructions "),s("strong",[t._v("using the webroot mode")]),t._v(".\nDon't forget to change the example domain to your own! An example of a valid certbot command (in this case for Debian Jessie) would be:")]),t._v(" "),t._m(76),t._m(77),t._v(" "),t._m(78),t._v(" "),t._m(79),t._m(80),t._v(" "),s("p",[t._v("Regardless of the option you choose, make sure you change the port to listen in on HTTPS traffic.")]),t._v(" "),t._m(81),t._m(82),t._v(" "),t._m(83),t._v(" "),s("p",[t._v("You may want to redirect all HTTP traffic to HTTPS, you can do this by adding the following to the NGINX configuration.\nThis will essentially replace the HTTP url with the HTTPS version!")]),t._v(" "),t._m(84),s("p",[t._v("It might be the case that you can't use standard ports. When trying to access a HTTPS port with HTTP, NGINX will respond with a "),s("code",[t._v("400 Bad Request")]),t._v('.\nWe can redirect this gracefully using a "HTTPS '),s("a",{attrs:{href:"http://nginx.org/en/docs/http/ngx_http_core_module.html#error_page",target:"_blank",rel:"noopener noreferrer"}},[t._v("error page"),s("OutboundLink")],1),t._v('" for the '),s("a",{attrs:{href:"http://nginx.org/en/docs/http/ngx_http_ssl_module.html#errors",target:"_blank",rel:"noopener noreferrer"}},[t._v("non-standard HTTP error code 497"),s("OutboundLink")],1)]),t._v(" "),t._m(85),t._m(86),t._v(" "),t._m(87),t._v(" "),t._m(88),t._m(89),t._v(" "),s("p",[t._v("To test your security settings "),s("a",{attrs:{href:"https://www.ssllabs.com/ssltest/",target:"_blank",rel:"noopener noreferrer"}},[t._v("SSL Labs"),s("OutboundLink")],1),t._v(' provides a tool for testing your domain against ideal settings (Make sure you check "Do not show the results on the boards" if you dont want your domain seen).')]),t._v(" "),t._m(90),t._v(" "),t._m(91),t._v(" "),t._m(92),s("p",[t._v("Now we can configure NGINX to use this key, as well as telling the client to use specific cyphers and SSL settings, just add the following under your "),s("code",[t._v("ssl_certificate **")]),t._v(" settings but above "),s("code",[t._v("location *")]),t._v(".\nAll of these settings are customisable, but make sure you "),s("a",{attrs:{href:"http://nginx.org/en/docs/http/configuring_https_servers.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("read up on"),s("OutboundLink")],1),t._v(" what these do first before changing them:")]),t._v(" "),t._m(93),s("p",[t._v("Feel free to test the new configuration again on "),s("a",{attrs:{href:"https://www.ssllabs.com/ssltest/",target:"_blank",rel:"noopener noreferrer"}},[t._v("SSL Labs"),s("OutboundLink")],1),t._v(".\nIf you're achieving A or A+ here, then your client-openHAB communication is very secure.")]),t._v(" "),t._m(94),t._v(" "),s("p",[t._v("The setup above is a suggestion for high compatibility with an A+ rating at the time of writing, however flaws in these settings (particularly the cyphers) may become known overtime.\nThe following articles may be useful when understanding and changing these settings.")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://bettercrypto.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Better Crypto"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.ssllabs.com/projects/best-practices/",target:"_blank",rel:"noopener noreferrer"}},[t._v("SSL Labs - Best Practices"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://hynek.me/articles/hardening-your-web-servers-ssl-ciphers/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Hynek Schlawack - Hardening Your Web Server’s SSL Ciphers"),s("OutboundLink")],1)])]),t._v(" "),s("DocPreviousVersions"),t._v(" "),s("EditPageLink")],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"securing-access-to-openhab"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#securing-access-to-openhab","aria-hidden":"true"}},[this._v("#")]),this._v(" Securing access to openHAB")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#encrypted-communication"}},[t._v("Encrypted Communication")]),s("ul",[s("li",[s("a",{attrs:{href:"#webserver-ports"}},[t._v("Webserver Ports")])]),s("li",[s("a",{attrs:{href:"#ssl-certificates"}},[t._v("SSL Certificates")])])])]),s("li",[s("a",{attrs:{href:"#authentication-and-access-control"}},[t._v("Authentication and Access Control")])]),s("li",[s("a",{attrs:{href:"#options-for-secure-remote-access"}},[t._v("Options for Secure Remote Access")]),s("ul",[s("li",[s("a",{attrs:{href:"#vpn-connection"}},[t._v("VPN Connection")])]),s("li",[s("a",{attrs:{href:"#myopenhab-cloud-service"}},[t._v("myopenHAB Cloud Service")])]),s("li",[s("a",{attrs:{href:"#running-openhab-behind-a-reverse-proxy"}},[t._v("Running openHAB Behind a Reverse Proxy")])])])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"encrypted-communication"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#encrypted-communication","aria-hidden":"true"}},[this._v("#")]),this._v(" Encrypted Communication")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"webserver-ports"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#webserver-ports","aria-hidden":"true"}},[this._v("#")]),this._v(" Webserver Ports")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The default ports 8080 and 8443 can be changed by setting the environment variables "),e("code",[this._v("OPENHAB_HTTP_PORT")]),this._v(" resp. "),e("code",[this._v("OPENHAB_HTTPS_PORT")]),this._v(".\nIn an apt installation, you would best do this in the file "),e("code",[this._v("/etc/default/openhab2")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"ssl-certificates"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ssl-certificates","aria-hidden":"true"}},[this._v("#")]),this._v(" SSL Certificates")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("On the very first start, openHAB generates a personal (self-signed, 256-bit ECC) SSL certificate and stores it in the Jetty keystore (in "),e("code",[this._v("${USER_DATA}etc/keystore")]),this._v(").\nThis process makes sure that every installation has an individual certificate, so that nobody else can falsely mimic your server.\nNote that on slow hardware, this certificate generation can take up to several minutes, so be patient on a first start - it is all for your own security.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"authentication-and-access-control"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#authentication-and-access-control","aria-hidden":"true"}},[this._v("#")]),this._v(" Authentication and Access Control")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("Security Warning:")]),this._v("\nIt is vitally important that you MUST NOT directly expose your openHAB instance to the Internet (e.g. by opening a port in your firewall)!")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("If you want to limit access to only certain network interfaces, you can do so by setting the environment variable "),e("code",[this._v("OPENHAB_HTTP_ADDRESS")]),this._v(".\nSetting it to")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-conf extra-class"},[e("pre",{pre:!0,attrs:{class:"language-dsl"}},[e("code",[this._v("OPENHAB_HTTP_ADDRESS"),e("span",{pre:!0,attrs:{class:"token operator"}},[this._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[this._v("127.0")]),e("span",{pre:!0,attrs:{class:"token number"}},[this._v(".0")]),e("span",{pre:!0,attrs:{class:"token number"}},[this._v(".1")]),this._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"options-for-secure-remote-access"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#options-for-secure-remote-access","aria-hidden":"true"}},[this._v("#")]),this._v(" Options for Secure Remote Access")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"vpn-connection"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vpn-connection","aria-hidden":"true"}},[this._v("#")]),this._v(" VPN Connection")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"myopenhab-cloud-service"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#myopenhab-cloud-service","aria-hidden":"true"}},[this._v("#")]),this._v(" myopenHAB Cloud Service")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"running-openhab-behind-a-reverse-proxy"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#running-openhab-behind-a-reverse-proxy","aria-hidden":"true"}},[this._v("#")]),this._v(" Running openHAB Behind a Reverse Proxy")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("A reverse proxy simply directs client requests to the appropriate server.\nThis means you can proxy connections to "),s("code",[t._v("http://mydomain_or_myip")]),t._v(" to your openHAB runtime.\nYou just have to "),s("strong",[t._v("replace "),s("em",[t._v("mydomain_or_myip")])]),t._v(" with either an "),s("strong",[t._v("internal or external IP")]),t._v(" (e.g. xx.xx.xx.xx) or a "),s("strong",[t._v("domain")]),t._v(" if you own one that links to the external IP of openHAB (e.g. openhab.mydomain.tld).")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Running openHAB behind a reverse proxy allows you to access your openHAB runtime via port 80 (HTTP) and 443 (HTTPS).\nIt also provides you a simple way of "),e("strong",[this._v("protecting your server")]),this._v(" with authentication and secure certificates.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("Table of Content:")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[s("a",{attrs:{href:"#nginx-setup"}},[t._v("Setting up NGINX")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#nginx-setup-install"}},[t._v("Installation")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-setup-config"}},[t._v("Basic Configuration")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-auth"}},[t._v("Authentication with NGINX")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#nginx-auth-user"}},[t._v("Creating the First User")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-auth-file"}},[t._v("Referencing the File in the NGINX Configuration")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-auth-users"}},[t._v("Adding or Removing users")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-satisfy"}},[t._v("Making Exceptions for Specific IP addresses")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-domain"}},[t._v("Setting up a Domain")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-https"}},[t._v("Enabling HTTPS")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-openssl"}},[t._v("Using OpenSSL to Generate Self-Signed Certificates")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#nginx-openssl-add"}},[t._v("Adding the Certificates to Your Proxy Server")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-letsencrypt"}},[t._v("Using Let's Encrypt to Generate Trusted Certificates")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#nginx-letsencrypt-generation"}},[t._v("Setting up the NGINX Proxy Server to Handle the Certificate Generation Procedure")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-letsencrypt-certbot"}},[t._v("Using Certbot")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-letsencrypt-add"}},[t._v("Adding the Certificates to Your Proxy Server")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-https-listen"}},[t._v("Setting Your NGINX Server to Listen to the HTTPS Port")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-httpredirect"}},[t._v("Redirecting HTTP Traffic to HTTPS")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-summary"}},[t._v("Putting it All Together")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-https-security"}},[t._v("Additional HTTPS Security")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#nginx-further-reading"}},[t._v("Further Reading")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"setting-up-nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-nginx","aria-hidden":"true"}},[this._v("#")]),this._v(" Setting up NGINX")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"installation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#installation","aria-hidden":"true"}},[this._v("#")]),this._v(" Installation")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" nginx\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Once installed, you can test to see if the service is running correctly by going to "),e("code",[this._v("http://mydomain_or_myip")]),this._v(', you should see the default "Welcome to nginx" page.\nIf you don\'t, you may need to check your firewall or ports and check if port 80 (and 443 for HTTPS later) is not blocked and that services can use it.')])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"basic-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#basic-configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Basic Configuration")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("NGINX configures the server when it starts up based on configuration files.\nThe location of the default setup is "),e("code",[this._v("/etc/nginx/sites-enabled/default")]),this._v(". To allow NGINX to proxy openHAB, you need to change this file (make a backup of it in a different folder first).")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The recommended configuration below assumes that you run the reverse proxy on the same machine as your openHAB runtime.\nIf this doesn't fit for you, you just have to replace "),e("code",[this._v("proxy_pass http://localhost:8080/")]),this._v(" by your openHAB runtime hostname (such as "),e("code",[this._v("http://youropenhabhostname:8080/")]),this._v(").")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("                                    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("                               mydomain_or_myip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v("                            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("localhost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" Host                 "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Real"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("IP            "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Forwarded"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("For      "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Forwarded"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Proto    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$scheme")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[this._v("mv")]),this._v(" /etc/nginx/sites-enabled/default /etc/nginx/sites-enabled/openhab\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Otherwise, create a new file. "),e("strong",[this._v("Every file in the "),e("code",[this._v("sites-enabled")]),this._v(" folder gets processed by NGINX, so make sure you only have one per site.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("After saving over the file but "),e("strong",[this._v("before you commit")]),this._v(" the changes to our server, you should "),e("strong",[this._v("test")]),this._v(" to see if our changes contain any errors; this is done with the command:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" nginx -t\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[this._v("service")]),this._v(" nginx restart\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("...and then go to "),e("code",[this._v("http://mydomain_or_myip")]),this._v(" to see your openHAB server.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"authentication-with-nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#authentication-with-nginx","aria-hidden":"true"}},[this._v("#")]),this._v(" Authentication with NGINX")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("For further security, you may wish to ask for a "),e("strong",[this._v("username and password")]),this._v(" before users have access to openHAB.\nThis is fairly simple in NGINX once you have the reverse proxy setup, you just need to provide the server with a basic authentication user file.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("Note:")]),this._v(" There is currently an issue with Proxy Authentication and HABmin when using some browsers.\nIf you require HABmin, consider connecting locally or using Safari for now.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"creating-the-first-user"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#creating-the-first-user","aria-hidden":"true"}},[this._v("#")]),this._v(" Creating the First User")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("You will be using "),e("em",[this._v("htpasswd")]),this._v(" to generate a username/password file, this utility can be found in the apache2-utils package:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[this._v("apt-get")]),this._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[this._v("install")]),this._v(" apache2-utils\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("To generate a file that NGINX can use you use the following command, don't forget to change "),e("em",[this._v("username")]),this._v(" to something meaningful!")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" htpasswd -c /etc/nginx/.htpasswd username\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"referencing-the-file-in-the-nginx-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#referencing-the-file-in-the-nginx-configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Referencing the File in the NGINX Configuration")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Now the configuration file ("),e("code",[this._v("/etc/nginx/sites-enabled/openhab")]),this._v(") needs to be edited to use this password.\nOpen the configuration file and "),e("strong",[this._v("add")]),this._v(" the following lines underneath the proxy_* settings:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[t._v("        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auth_basic")]),t._v("                            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Username and Password Required"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auth_basic_user_file")]),t._v("                  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("htpasswd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Once done, "),e("strong",[this._v("test and restart your NGINX service")]),this._v(" and authentication should now be enabled on your server!")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"adding-or-removing-users"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#adding-or-removing-users","aria-hidden":"true"}},[this._v("#")]),this._v(" Adding or Removing users")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("To add new users to your site, you must use following command, "),e("strong",[this._v("do not")]),this._v(" use the "),e("code",[this._v("-c")]),this._v(" modifier again as this will remove all previously created users:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" htpasswd /etc/nginx/.htpasswd username\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" htpasswd -D /etc/nginx/.htpasswd username\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Once again, any changes you make to these files "),e("strong",[this._v("must be followed with restarting the NGINX service")]),this._v(" otherwise no changes will be made.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"making-exceptions-for-specific-ip-addresses"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#making-exceptions-for-specific-ip-addresses","aria-hidden":"true"}},[this._v("#")]),this._v(" Making Exceptions for Specific IP addresses")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("It is often desirable to allow specific IPs (e.g. the local network) to access openHAB without needing to prompt for a password or to block everyone else entirely.\nIn these cases NGINX can use the "),s("code",[t._v("satisfy any")]),t._v(" directive followed by "),s("code",[t._v("allow")]),t._v(" and "),s("code",[t._v("deny")]),t._v(" lines to make these exceptions.\nThese lines are placed in the "),s("code",[t._v("location{}")]),t._v(" block. For example, by adding the lines:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[t._v("        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("satisfy")]),t._v("  any"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("allow")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("allow")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("deny")]),t._v("     all"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("NGINX will allow anyone within the 192.168.0.1/24 range "),e("strong",[this._v("and")]),this._v(" the localhost to connect without a password.\nIf you have setup a password following the previous section, then the rest will be prompted for a password for access.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"setting-up-a-domain"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-a-domain","aria-hidden":"true"}},[this._v("#")]),this._v(" Setting up a Domain")])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[this._v("Method")]),this._v(" "),e("th",{staticStyle:{"text-align":"left"}},[this._v("Example Links")]),this._v(" "),e("th",{staticStyle:{"text-align":"left"}},[this._v("Note")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("td",{staticStyle:{"text-align":"left"}},[this._v("You should have an IP adress that doesn't change (i.e. fixed), or changes rarely, and then update the DNS "),e("em",[this._v("A record")]),this._v(" so that your domain/subdomain to point towards your IP.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"enabling-https"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#enabling-https","aria-hidden":"true"}},[this._v("#")]),this._v(" Enabling HTTPS")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("If you have a "),e("strong",[this._v("valid domain and can change the DNS")]),this._v(" to point towards your IP, follow the "),e("a",{attrs:{href:"#nginx-letsencrypt"}},[this._v("instructions for Let's Encrypt")]),this._v("\nIf you need to use an internal or external IP to connect to openHAB, follow the "),e("a",{attrs:{href:"#nginx-openssl"}},[this._v("instructions for OpenSSL")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"using-openssl-to-generate-self-signed-certificates"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-openssl-to-generate-self-signed-certificates","aria-hidden":"true"}},[this._v("#")]),this._v(" Using OpenSSL to Generate Self-Signed Certificates")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[this._v("apt-get")]),this._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[this._v("install")]),this._v(" openssl\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[this._v("mkdir")]),this._v(" -p /etc/ssl/certs\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" openssl req -x509 -nodes -days "),e("span",{pre:!0,attrs:{class:"token number"}},[this._v("365")]),this._v(" -newkey rsa:2048 -keyout /etc/ssl/openhab.key -out /etc/ssl/openhab.crt\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("You will be prompted for some information which you will need to fill out for the certificate, when it asks for a "),e("strong",[this._v("Common Name")]),this._v(", you may enter your IP Address:\nCommon Name (e.g. server FQDN or YOUR name) []: xx.xx.xx.xx")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"adding-the-certificates-to-your-proxy-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#adding-the-certificates-to-your-proxy-server","aria-hidden":"true"}},[this._v("#")]),this._v(" Adding the Certificates to Your Proxy Server")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The certificate and key should have been placed in "),e("code",[this._v("/etc/ssl/")]),this._v(".\nNGINX needs to be told where these files are and then enable the reverse proxy to direct HTTPS traffic.\nIn the NGINX configuration, place the following underneath your "),e("code",[this._v("server_name")]),this._v(" variable:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate")]),t._v("                 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("openhab"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("crt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate_key")]),t._v("             "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("openhab"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"using-let-s-encrypt-to-generate-trusted-certificates"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-let-s-encrypt-to-generate-trusted-certificates","aria-hidden":"true"}},[this._v("#")]),this._v(" Using Let's Encrypt to Generate Trusted Certificates")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("Skip this step if you have no domain name or have already followed the instructions for OpenSSL")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"setting-up-the-nginx-proxy-server-to-handle-the-certificate-generation-procedure"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-the-nginx-proxy-server-to-handle-the-certificate-generation-procedure","aria-hidden":"true"}},[this._v("#")]),this._v(" Setting up the NGINX Proxy Server to Handle the Certificate Generation Procedure")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Let's Encrypt needs to validate that the server has control of the domain.\nThe simplest way of doing this is using a "),e("strong",[this._v("webroot plugin")]),this._v(" to place a file on the server, and then access it using a specific url: "),e("em",[this._v("/.well-known/acme-challenge")]),this._v(".\nSince the proxy only forwards traffic to the openHAB server, the server needs to be told to handle requests at this address differently.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("First, "),e("strong",[this._v("create a directory")]),this._v(" that Certbot can be given access to:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-rules"}},[s("code",[t._v("sudo mkdir "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mydomain\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Next add the new location parameter to your NGINX config, this should be "),e("strong",[this._v("placed above the last brace")]),this._v(" in the server setting:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("well"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("known"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("acme"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("challenge"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("                            "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mydomain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"using-certbot"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#using-certbot","aria-hidden":"true"}},[this._v("#")]),this._v(" Using Certbot")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-rules"}},[s("code",[t._v("sudo certbot certonly "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("webroot "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("w "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mydomain "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d mydomain\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h5",{attrs:{id:"adding-the-certificates-to-your-proxy-server-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#adding-the-certificates-to-your-proxy-server-2","aria-hidden":"true"}},[this._v("#")]),this._v(" Adding the Certificates to Your Proxy Server")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The certificate and key should have been placed in "),e("code",[this._v("/etc/letsencrypt/live/mydomain_or_myip")]),this._v(".\nNGINX needs to be told where these files are and then enable the reverse proxy to direct HTTPS traffic, using Strict Transport Security to prevent man-in-the-middle attacks.\nIn the NGINX configuration, place the following underneath your server_name variable:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate")]),t._v("                 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("letsencrypt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("live"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mydomain_or_myip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("fullchain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate_key")]),t._v("             "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("letsencrypt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("live"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mydomain_or_myip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("privkey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v("                      Strict"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Transport"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Security "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"max-age=31536000"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"setting-your-nginx-server-to-listen-to-the-https-port"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setting-your-nginx-server-to-listen-to-the-https-port","aria-hidden":"true"}},[this._v("#")]),this._v(" Setting Your NGINX Server to Listen to the HTTPS Port")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("                          "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("After restarting NGINX service, you will be using a valid HTTPS certificate.\nYou can check by going to "),e("code",[this._v("https://mydomain_or_myip")]),this._v(" and confirming with your browser that you have a valid certificate.\n"),e("strong",[this._v("These certificates expire within a few months")]),this._v(" so it is important to run the updater in a cron expression (and also restart NGINX) as explained in the Certbot setup instructions.\nIf you want to keep hold of a HTTP server for some reason, just add "),e("code",[this._v("listen 80;")]),this._v(" and remove the Strict-Transport-Security line.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"redirecting-http-traffic-to-https"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#redirecting-http-traffic-to-https","aria-hidden":"true"}},[this._v("#")]),this._v(" Redirecting HTTP Traffic to HTTPS")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("                          "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("                     mydomain_or_myip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v("                      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("https")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$server_name")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_uri")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("                          "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8084")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("                     mydomain_or_myip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("error_page")]),t._v("                      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("497")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("https")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$host")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$server_port")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_uri")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"putting-it-all-together"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#putting-it-all-together","aria-hidden":"true"}},[this._v("#")]),this._v(" Putting it All Together")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("After following all the steps on this page, you "),e("em",[this._v("should")]),this._v(" have a NGINX server configuration ("),e("code",[this._v("/etc/nginx/sites-enabled/openhab")]),this._v(") that looks like this:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("                          "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("                     mydomain_or_myip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v("                      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("https")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$server_name")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$request_uri")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("                          "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server_name")]),t._v("                     mydomain_or_myip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate")]),t._v("                 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("letsencrypt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("live"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mydomain"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("fullchain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# or /etc/ssl/openhab.crt")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_certificate_key")]),t._v("             "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("letsencrypt"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("live"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mydomain"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("privkey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# or /etc/ssl/openhab.key")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v("                      Strict"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Transport"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Security "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"max-age=31536000"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Remove if using self-signed and are having trouble.")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_pass")]),t._v("                              "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("http")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("localhost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" Host                   "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Real"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("IP              "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Forwarded"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("For        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("proxy_set_header")]),t._v(" X"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Forwarded"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Proto      "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$scheme")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("satisfy")]),t._v("                                 any"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("allow")]),t._v("                                   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("allow")]),t._v("                                   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("deny")]),t._v("                                    all"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auth_basic")]),t._v("                              "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Username and Password Required"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("auth_basic_user_file")]),t._v("                    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("htpasswd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#### When using Let's Encrypt Only ####")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("well"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("known"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("acme"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("challenge"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("root")]),t._v("                                    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("var"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("www"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mydomain"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"additional-https-security"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#additional-https-security","aria-hidden":"true"}},[this._v("#")]),this._v(" Additional HTTPS Security")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("This optional section is for those who would like to strengthen the HTTPS security on openHAB, it can be applied regardless of which HTTPS method you used "),e("a",{attrs:{href:"#nginx-https"}},[this._v("above")]),this._v(", "),e("strong",[this._v("but you need to follow at least one of them first")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("First, we need to generate a stronger key exchange, to do this we can generate an additional key with OpenSSL "),e("strong",[this._v("Note: this will take a few minutes to complete:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("mkdir")]),this._v(" -p /etc/nginx/ssl\nopenssl dhparam -out /etc/nginx/ssl/dhparam.pem "),e("span",{pre:!0,attrs:{class:"token number"}},[this._v("4096")]),this._v("\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_protocols")]),t._v("                   TLSv1 TLSv1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" TLSv1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_prefer_server_ciphers")]),t._v("       on"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_dhparam")]),t._v("                     "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("dhparam"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_ciphers")]),t._v("                     ECDHE"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ECDSA"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AES256"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("GCM"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("SHA384"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("ECDHE"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("RSA"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AES256"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("GCM"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("SHA384"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("ECDHE"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ECDSA"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AES256"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("SHA384"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("ECDHE"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("RSA"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AES256"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("SHA384"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("ECDHE"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ECDSA"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AES128"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("GCM"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("SHA256"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("ECDHE"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("RSA"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AES128"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("GCM"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("SHA256"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("ECDHE"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ECDSA"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AES128"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("SHA256"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("ECDHE"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("RSA"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AES128"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("SHA256"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("ECDHE"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("RSA"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("AES256"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("SHA"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("HIGH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("aNULL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("eNULL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("LOW"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("DES"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("MD5"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("EXP"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("CBC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("EDH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("kEDH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("PSK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("SRP"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("kECDH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_session_timeout")]),t._v("             "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl_session_cache")]),t._v("               shared"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SSL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("m"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("keepalive_timeout")]),t._v("               "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("70")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"further-reading"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#further-reading","aria-hidden":"true"}},[this._v("#")]),this._v(" Further Reading")])}],!1,null,null,null);e.default=r.exports}}]);