(window.webpackJsonp=window.webpackJsonp||[]).push([[203],{735:function(t,e,s){"use strict";s.r(e);var n=s(0),a=Object(n.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"gpio-binding"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gpio-binding","aria-hidden":"true"}},[t._v("#")]),t._v(" GPIO Binding "),s("Badge",{attrs:{type:"warn",text:"v1"}})],1),t._v(" "),s("p",[t._v("This binding is for the local GPIO subsystem. It is currently only exposed to user space by "),s("a",{attrs:{href:"https://www.kernel.org/doc/Documentation/gpio/sysfs.txt",target:"_blank",rel:"noopener noreferrer"}},[t._v("Linux GPIO framework"),s("OutboundLink")],1),t._v(". Being based on a kernel implementation, it's hardware agnostic and works on different boards without modification (this is on theory only, not all existing boards can be tested).")]),t._v(" "),s("p",[t._v("The difference from other bindings dealing with GPIOs is that it works with GPIO subsystem on the board on which openHAB runs and doesn't require third-party programs/daemons running. The binding consists of two components: base module (org.openhab.io.gpio) which implements low-level GPIO access and provides API for high-level modules (can be used by other bindings needing to interact directly with GPIOs) and the binding itself (org.openhab.binding.gpio) which introduces hardware GPIO pins as full-featured openHAB items capable of generating events or receiving commands depending of their type (input or output).")]),t._v(" "),t._m(0),t._v(" "),s("ul",[t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),s("li",[s("p",[t._v("See "),s("a",{attrs:{href:"https://github.com/java-native-access/jna",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/java-native-access/jna"),s("OutboundLink")],1),t._v(" for supported platforms")])]),t._v(" "),t._m(5)]),t._v(" "),s("p",[t._v('Alternatively you can add the user "openhab" to the usergroup "gpio", if your distribution (like rasbian) does have such a group.')]),t._v(" "),t._m(6),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._m(13),t._v(" "),t._m(14),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),s("p",[t._v("Examples:")]),t._v(" "),t._m(18),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),s("p",[t._v('The "force" option can be used to forcefully get hold of the configured pin even if it is currently in use, so it automatically gets unexported and exported again.')]),t._v(" "),s("p",[t._v("Examples:")]),t._v(" "),t._m(29),t._m(30),t._v(" "),s("p",[t._v("When using the init.d startup script from this wiki ("),s("a",{attrs:{href:"https://github.com/openhab/openhab1-addons/wiki/Samples-Tricks#how-to-configure-openhab-to-start-automatically-on-linux",target:"_blank",rel:"noopener noreferrer"}},[t._v("link"),s("OutboundLink")],1),t._v(") and you try to stop openHAB it will not unexport your gpio pins. You can do this manually or edit the startup script like bellow.")]),t._v(" "),s("p",[t._v("First find the stop section: Look for the do_stop() function and insert your unexports:")]),t._v(" "),s("p",[t._v("init.d script:")]),t._v(" "),t._m(31),s("p",[t._v("Naturally edit the number after the echo to the gpio pin you use and insert or remove lines matching the number of gpio's in use.")]),t._v(" "),s("p",[t._v("Now you can stop and start openhab without your GPIO pins getting blocked!")]),t._v(" "),s("DocPreviousVersions"),t._v(" "),s("EditPageLink")],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"prerequisites"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites","aria-hidden":"true"}},[this._v("#")]),this._v(" Prerequisites")])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("p",[this._v("Linux-based OS with GPIO driver loaded (check whether exists directory "),e("code",[this._v("/sys/class/gpio")]),this._v("), usually it's compiled into the kernel for all recent boards which exposes GPIOs")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("p",[this._v("Mounted "),e("code",[this._v("sysfs")]),this._v(" pseudo file system, the mount point can be:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("p",[this._v("Automatically determined if "),e("code",[this._v("procfs")]),this._v(" is mounted under path "),e("code",[this._v("/proc")]),this._v(", this is the default path in almost all configurations")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("p",[this._v("Manually set in openHAB configuration file, key "),e("code",[this._v("gpio:sysfs")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("p",[this._v('root privileges, openHAB should be run under "root" account.')])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" adduser openhab gpio\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("em",[this._v("NOTE: Some boards may need additional pin configuration prior using them, for example OMAP-based processors are using pin multiplexing which require changing the mode for some of the pins. Please refer to board's System Reference Manual for more information whether preliminary configuration is needed and how to do it.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Some manual configuration may be needed.  The following edit to "),e("code",[this._v("/etc/default/openhab")]),this._v(" may be necessary (see discussion above in Prerequisites section).  If needed, set:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("JAVA_ARGS=-Djna.boot.library.path=/usr/lib/jni\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The "),e("code",[this._v("JAVA_ARGS")]),this._v(" edit may not be necessary, and could cause openHAB to crash.  If it does, simply undo the edit and restart openHAB.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("If you chose above to add the openhab user to the gpio group, then you shouldn't make the changes below to run as root.  If you did not add the openhab user to the gpio group, make a further edit to "),e("code",[this._v("/etc/default/openhab")]),this._v(":")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("USER_AND_GROUP=root:root\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("And then edit "),e("code",[this._v("/usr/lib/systemd/system/openhab.service")]),this._v(" and set the following:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-dsl"}},[e("code",[this._v("User"),e("span",{pre:!0,attrs:{class:"token operator"}},[this._v("=")]),this._v("root\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[this._v("Group")]),e("span",{pre:!0,attrs:{class:"token operator"}},[this._v("=")]),this._v("root\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"binding-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#binding-configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Binding Configuration")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("This binding can be configured in the file "),e("code",[this._v("services/gpio.cfg")]),this._v(".")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",[s("thead",[s("tr",[s("th",[t._v("Property")]),t._v(" "),s("th",[t._v("Default")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("Required")]),t._v(" "),s("th",[t._v("Description")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("sysfs")]),t._v(" "),s("td"),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",[t._v("optional directory path where "),s("code",[t._v("sysfs")]),t._v(" pseudo file system is mounted. If isn't specified it will be determined automatically (if "),s("code",[t._v("procfs")]),t._v(" is mounted under "),s("code",[t._v("/proc")]),t._v(").")])]),t._v(" "),s("tr",[s("td",[t._v("debounce")]),t._v(" "),s("td",[t._v("0")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}}),t._v(" "),s("td",[t._v("optional time interval in milliseconds in which pin interrupts for input pins will be ignored to prevent bounce effect seen mainly on buttons. Global option for all pins, can be customized per pin in item configuration.")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("sysfs=/sys\ndebounce=10\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("em",[this._v("NOTE: While change in these global options is allowed at runtime it's not advisable to do that. This is because only newly created pins will use the new values while currently existing pins will use the old one.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("em",[this._v("NOTE: These options are optional, in most circumstances you don't have to specify them.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"item-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#item-configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Item Configuration")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("Allowed item types are "),s("code",[t._v("Contact")]),t._v(" and "),s("code",[t._v("Switch")]),t._v(". Type "),s("code",[t._v("Contact")]),t._v(" is used for input pins, "),s("code",[t._v("Switch")]),t._v(" - for output pins. The configuration string is following:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('gpio="pin:PIN_NUMBER [debounce:DEBOUNCE_INTERVAL] [activelow:yes|no] [force:yes|no] [initialValue:high|low]"\n')])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("Key-value pairs are separated by space; their order isn't important. Character's case is also insignificant. Key-value pair "),s("code",[t._v("pin")]),t._v(" is mandatory, "),s("code",[t._v("debounce")]),t._v(", "),s("code",[t._v("activelow")]),t._v(" and "),s("code",[t._v("initialValue")]),t._v(" are optional. If omitted "),s("code",[t._v("activelow")]),t._v(" is set to "),s("code",[t._v("no")]),t._v(", "),s("code",[t._v("debounce")]),t._v(" - to global option in configuration file ("),s("code",[t._v("debounce")]),t._v(") or 0 (zero) if neither is specified, initialValue is set to LOW.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("PIN_NUMBER")]),this._v(" is the number of the GPIO pin as seen by the kernel (not necessarily the same as the physical pin number).")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("DEBOUNCE_INTERVAL")]),this._v(" is the time interval in milliseconds in which pin interrupts for input pins will be ignored to prevent bounce effect seen mainly on buttons. Note that underlying OS isn't real time nor the application is, so debounce implementation isn't something on which you can rely on 100%, you may need to experiment with this value.")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("When "),s("code",[t._v("activelow")]),t._v(" is set to "),s("code",[t._v("no")]),t._v(" (or omitted) the pins behaves normally: output pins will be set "),s("code",[t._v("high")]),t._v(" on "),s("code",[t._v("ON")]),t._v(" command and "),s("code",[t._v("low")]),t._v(" on "),s("code",[t._v("OFF")]),t._v(", input pins will generate "),s("code",[t._v("OPEN")]),t._v(" event when they are "),s("code",[t._v("high")]),t._v(" and "),s("code",[t._v("CLOSED")]),t._v(" when are "),s("code",[t._v("low")]),t._v(". However, if "),s("code",[t._v("activelow")]),t._v(" is set to "),s("code",[t._v("yes")]),t._v(" the logic is inverted: when "),s("code",[t._v("ON")]),t._v(" command is sent to output pin it will be set to "),s("code",[t._v("low")]),t._v(", on "),s("code",[t._v("OFF")]),t._v(" command - to "),s("code",[t._v("high")]),t._v(". Input pins will generate "),s("code",[t._v("OPEN")]),t._v(" event when they are "),s("code",[t._v("low")]),t._v(" and "),s("code",[t._v("CLOSED")]),t._v(" event on "),s("code",[t._v("high")]),t._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("initialValue")]),this._v(" is the state of the pin which is set during initialization. It is applicable only for oputput pins (item Switch) and can be HIGH or LOW.")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dsl"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Switch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LED")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LED"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" gpio"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pin:1"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Switch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NormallyClosedRelay")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Normally Closed Relay"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" gpio"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pin:2 activelow:yes initialValue:high"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Contact")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NormallyOpenPushButton")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Normally Open Push Button"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" gpio"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pin:3 debounce:10"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Contact")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PIR")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"PIR"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" gpio"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pin:4 activelow:yes"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Contact")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NormallyClosedPushButton")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Normally Closed Push Button"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" gpio"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pin:5 debounce:10 activelow:yes"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Contact")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ForcePin")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Force access to pin"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" gpio"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pin:6 force:yes"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"automatic-unexport-when-using-init-d-script"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#automatic-unexport-when-using-init-d-script","aria-hidden":"true"}},[this._v("#")]),this._v(" Automatic unexport when using init.d script")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("do_stop")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# Return <Badge type="warn" text="v1"/>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#   0 if daemon has been stopped <Badge type="warn" text="v1"/>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#   1 if daemon was already stopped <Badge type="warn" text="v1"/>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#   2 if daemon could not be stopped <Badge type="warn" text="v1"/>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('#   other if a failure occurred <Badge type="warn" text="v1"/>')]),t._v("\nstart-stop-daemon --stop --quiet --retry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("TERM")]),t._v("/30/KILL/5 --pidfile "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PIDFILE")]),t._v(" $\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#unexport all gpio's")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /sys/class/gpio/unexport\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("23")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /sys/class/gpio/unexport\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /sys/class/gpio/unexport\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /sys/class/gpio/unexport\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /sys/class/gpio/unexport\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /sys/class/gpio/unexport\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /sys/class/gpio/unexport\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /sys/class/gpio/unexport\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("RETVAL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$?")]),t._v('"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$RETVAL")]),t._v('"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# Wait for children to finish too if this is a daemon that forks <Badge type="warn" text="v1"/>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# and if the daemon is only ever run from this initscript. <Badge type="warn" text="v1"/>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# If the above conditions are not satisfied then add some other code <Badge type="warn" text="v1"/>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# that waits for the process to drop all resources that could be <Badge type="warn" text="v1"/>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# needed by services started subsequently.  A last resort is to <Badge type="warn" text="v1"/>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# sleep for some time. <Badge type="warn" text="v1"/>')]),t._v("\nstart-stop-daemon --stop --quiet --oknodo --retry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("/30/KILL/5 --exec "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$DAEMON")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$?")]),t._v('"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# Many daemons don\'t delete their pidfiles when they exit. <Badge type="warn" text="v1"/>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -f "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$PIDFILE")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$RETVAL")]),t._v('"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])}],!1,null,null,null);e.default=a.exports}}]);