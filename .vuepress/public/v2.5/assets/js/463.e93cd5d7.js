(window.webpackJsonp=window.webpackJsonp||[]).push([[463],{786:function(t,e,s){"use strict";s.r(e);var a=s(0),r=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"jdbc-persistence"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jdbc-persistence","aria-hidden":"true"}},[t._v("#")]),t._v(" JDBC Persistence "),s("Badge",{attrs:{type:"warn",text:"v1"}})],1),t._v(" "),s("AddonLogo"),t._v(" "),s("p",[t._v("This service writes and reads item states to and from a number of relational database systems that support "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Java_Database_Connectivity",target:"_blank",rel:"noopener noreferrer"}},[t._v("Java Database Connectivity (JDBC)"),s("OutboundLink")],1),t._v(".  This service allows you to persist state updates using one of several different underlying database services. It is designed for a maximum of scalability, to store very large amounts of data and still over the years not lose its speed.")]),t._v(" "),s("p",[t._v("The generic design makes it relatively easy for developers to integrate other databases that have JDBC drivers.  The following databases are currently supported and tested:")]),t._v(" "),s("table",[t._m(0),t._v(" "),s("tbody",[s("tr",[s("td",[s("a",{attrs:{href:"https://db.apache.org/derby/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache Derby"),s("OutboundLink")],1)]),t._v(" "),s("td",[s("a",{attrs:{href:"http://mvnrepository.com/artifact/org.apache.derby/derby",target:"_blank",rel:"noopener noreferrer"}},[t._v("derby-10.12.1.1.jar"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[s("a",{attrs:{href:"http://www.h2database.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("H2"),s("OutboundLink")],1)]),t._v(" "),s("td",[s("a",{attrs:{href:"http://mvnrepository.com/artifact/com.h2database/h2",target:"_blank",rel:"noopener noreferrer"}},[t._v("h2-1.4.191.jar"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[s("a",{attrs:{href:"http://hsqldb.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("HSQLDB"),s("OutboundLink")],1)]),t._v(" "),s("td",[s("a",{attrs:{href:"http://mvnrepository.com/artifact/org.hsqldb/hsqldb",target:"_blank",rel:"noopener noreferrer"}},[t._v("hsqldb-2.3.3.jar"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[s("a",{attrs:{href:"https://mariadb.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("MariaDB"),s("OutboundLink")],1)]),t._v(" "),s("td",[s("a",{attrs:{href:"http://mvnrepository.com/artifact/org.mariadb.jdbc/mariadb-java-client",target:"_blank",rel:"noopener noreferrer"}},[t._v("mariadb-java-client-1.4.6.jar"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[s("a",{attrs:{href:"https://www.mysql.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("MySQL"),s("OutboundLink")],1)]),t._v(" "),s("td",[s("a",{attrs:{href:"http://mvnrepository.com/artifact/mysql/mysql-connector-java",target:"_blank",rel:"noopener noreferrer"}},[t._v("mysql-connector-java-5.1.39.jar"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[s("a",{attrs:{href:"http://www.postgresql.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PostgreSQL"),s("OutboundLink")],1)]),t._v(" "),s("td",[s("a",{attrs:{href:"http://mvnrepository.com/artifact/org.postgresql/postgresql",target:"_blank",rel:"noopener noreferrer"}},[t._v("postgresql-9.4.1209.jre7.jar"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[s("a",{attrs:{href:"https://www.sqlite.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("SQLite"),s("OutboundLink")],1)]),t._v(" "),s("td",[s("a",{attrs:{href:"http://mvnrepository.com/artifact/org.xerial/sqlite-jdbc",target:"_blank",rel:"noopener noreferrer"}},[t._v("sqlite-jdbc-3.16.1.jar"),s("OutboundLink")],1)])])])]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),s("table",[t._m(5),t._v(" "),s("tbody",[t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),s("tr",[s("td",[t._v("sqltype.CALL")]),t._v(" "),t._m(10),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("No")]),t._v(" "),s("td",[t._v("All "),s("code",[t._v("sqlType")]),t._v(" options allow you to change the SQL data type used to store values for different openHAB item states.  See the following links for further information: "),s("a",{attrs:{href:"https://mybatis.github.io/mybatis-3/apidocs/reference/org/apache/ibatis/type/JdbcType.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("mybatis"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"http://www.h2database.com/html/datatypes.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("H2"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"http://www.postgresql.org/docs/9.3/static/datatype.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PostgresSQL"),s("OutboundLink")],1)])]),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),s("tr",[s("td",[t._v("jdbc.maximumPoolSize")]),t._v(" "),t._m(27),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("No")]),t._v(" "),s("td",[t._v("Some embeded databases can handle only one connection.  See "),s("a",{attrs:{href:"https://github.com/brettwooldridge/HikariCP/issues/256",target:"_blank",rel:"noopener noreferrer"}},[t._v("this link"),s("OutboundLink")],1),t._v(" for more information")])]),t._v(" "),t._m(28),t._v(" "),t._m(29)])]),t._v(" "),t._m(30),t._v(" "),s("p",[t._v("To configure this service as the default persistence service for openHAB 2, add or change the line")]),t._v(" "),t._m(31),t._m(32),t._v(" "),t._m(33),t._v(" "),s("p",[t._v("services/jdbc.cfg")]),t._v(" "),t._m(34),t._m(35),t._v(" "),t._m(36),t._v(" "),s("p",[t._v("services/jdbc.cfg")]),t._v(" "),t._m(37),t._m(38),t._v(" "),t._m(39),t._v(" "),t._m(40),t._v(" "),s("p",[t._v("The table name schema can be reconfigured after creation, if needed.")]),t._v(" "),s("p",[t._v("The service will create a mapping table to link each item to a table, and a separate table is generated for each item.  The item data tables include time and data values.  The SQL data type used depends on the openHAB item type, and allows the item state to be recovered back into openHAB in the same way it was stored.")]),t._v(" "),t._m(41),t._v(" "),t._m(42),t._v(" "),t._m(43),t._v(" "),t._m(44),t._v(" "),t._m(45),t._v(" "),t._m(46),t._v(" "),t._m(47),t._v(" "),t._m(48),t._v(" "),s("p",[t._v("Not necessarily representative of the performance you may experience.")]),t._v(" "),t._m(49),t._v(" "),t._m(50),t._v(" "),s("p",[t._v("Used a script like this:")]),t._v(" "),t._m(51),s("DocPreviousVersions"),t._v(" "),s("EditPageLink")],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Database")]),this._v(" "),e("th",[this._v("Tested Driver / Version")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"table-of-contents"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#table-of-contents","aria-hidden":"true"}},[this._v("#")]),this._v(" Table of Contents")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[s("a",{attrs:{href:"#configuration"}},[t._v("Configuration")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#minimal-configuration"}},[t._v("Minimal Configuration")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#migration-from-mysql-to-jdbc-persistence-services"}},[t._v("Migration from MySQL to JDBC Persistence Services")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#technical-notes"}},[t._v("Technical Notes")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#database-table-schema"}},[t._v("Database Table Schema")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#number-precision"}},[t._v("Number Precision")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#rounding-results"}},[t._v("Rounding results")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#for-developers"}},[t._v("For Developers")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#performance-tests"}},[t._v("Performance Tests")])])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Configuration")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("This service can be configured in the file "),e("code",[this._v("services/jdbc.cfg")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("Property")]),this._v(" "),e("th",[this._v("Default")]),this._v(" "),e("th",{staticStyle:{"text-align":"center"}},[this._v("Required")]),this._v(" "),e("th",[this._v("Description")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",[t._v("url")]),t._v(" "),s("td"),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("Yes")]),t._v(" "),s("td",[t._v("JDBC URL to establish a connection to your database.  Examples:"),s("br"),s("br"),s("code",[t._v("jdbc:derby:./testDerby;create=true")]),s("br"),s("code",[t._v("jdbc:h2:./testH2")]),s("br"),s("code",[t._v("jdbc:hsqldb:./testHsqlDb")]),s("br"),s("code",[t._v("jdbc:mariadb://192.168.0.1:3306/testMariadb")]),s("br"),s("code",[t._v("jdbc:mysql://192.168.0.1:3306/testMysql?serverTimezone=UTC")]),s("br"),s("code",[t._v("jdbc:postgresql://192.168.0.1:5432/testPostgresql")]),s("br"),s("code",[t._v("jdbc:sqlite:./testSqlite.db")]),t._v("."),s("br"),s("br"),t._v("If no database is available it will be created; for example the url "),s("code",[t._v("jdbc:h2:./testH2")]),t._v(" creates a new H2 database in openHAB folder. Example to create your own MySQL database directly:"),s("br"),s("br"),s("code",[t._v("CREATE DATABASE 'yourDB' CHARACTER SET utf8 COLLATE utf8_general_ci;")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("user")]),this._v(" "),e("td"),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("if needed")]),this._v(" "),e("td",[this._v("database user name")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("password")]),this._v(" "),e("td"),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("if needed")]),this._v(" "),e("td",[this._v("database user password")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("errReconnectThreshold")]),this._v(" "),e("td",[this._v("0")]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),e("td",[this._v("when the service is deactivated (0 means ignore)")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("td",[e("code",[this._v("VARCHAR(200)")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("sqltype.COLOR")]),this._v(" "),e("td",[e("code",[this._v("VARCHAR(70)")])]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),e("td",[this._v("see above")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("sqltype.CONTACT")]),this._v(" "),e("td",[e("code",[this._v("VARCHAR(6)")])]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),e("td",[this._v("see above")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("sqltype.DATETIME")]),this._v(" "),e("td",[e("code",[this._v("DATETIME")])]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),e("td",[this._v("see above")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("sqltype.DIMMER")]),this._v(" "),e("td",[e("code",[this._v("TINYINT")])]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),e("td",[this._v("see above")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("sqltype.LOCATION")]),this._v(" "),e("td",[e("code",[this._v("VARCHAR(30)")])]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),e("td",[this._v("see above")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("sqltype.NUMBER")]),this._v(" "),e("td",[e("code",[this._v("DOUBLE")])]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),e("td",[this._v("see above")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("sqltype.ROLLERSHUTTER")]),this._v(" "),e("td",[e("code",[this._v("TINYINT")])]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),e("td",[this._v("see above")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("sqltype.STRING")]),this._v(" "),e("td",[e("code",[this._v("VARCHAR(65500)")])]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),e("td",[this._v("see above")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("sqltype.SWITCH")]),this._v(" "),e("td",[e("code",[this._v("VARCHAR(6)")])]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),e("td",[this._v("see above")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",[t._v("sqltype.tablePrimaryKey")]),t._v(" "),s("td",[s("code",[t._v("TIMESTAMP")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("No")]),t._v(" "),s("td",[t._v("type of "),s("code",[t._v("time")]),t._v(" column for newly created item tables")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",[t._v("sqltype.tablePrimaryValue")]),t._v(" "),s("td",[s("code",[t._v("NOW()")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("No")]),t._v(" "),s("td",[t._v("value of "),s("code",[t._v("time")]),t._v(" column for newly inserted rows")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("numberDecimalcount")]),this._v(" "),e("td",[this._v("3")]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),e("td",[this._v('for Itemtype "Number" default decimal digit count')])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",[t._v("tableNamePrefix")]),t._v(" "),s("td",[s("code",[t._v("item")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("No")]),t._v(" "),s("td",[t._v("table name prefix. For Migration from MySQL Persistence, set to "),s("code",[t._v("Item")]),t._v(".")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",[t._v("tableUseRealItemNames")]),t._v(" "),s("td",[s("code",[t._v("false")])]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("No")]),t._v(" "),s("td",[t._v("table name prefix generation.  When set to "),s("code",[t._v("true")]),t._v(", real item names are used for table names and "),s("code",[t._v("tableNamePrefix")]),t._v(" is ignored.  When set to "),s("code",[t._v("false")]),t._v(", the "),s("code",[t._v("tableNamePrefix")]),t._v(" is used to generate table names with sequential numbers.")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",[t._v("tableIdDigitCount")]),t._v(" "),s("td",[t._v("4")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("No")]),t._v(" "),s("td",[t._v("when "),s("code",[t._v("tableUseRealItemNames")]),t._v(" is "),s("code",[t._v("false")]),t._v(" and thus table names are generated sequentially, this controls how many zero-padded digits are used in the table name.  With the default of 4, the first table name will end with "),s("code",[t._v("0001")]),t._v(". For migration from the MySQL persistence service, set this to 0.")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",[t._v("rebuildTableNames")]),t._v(" "),s("td",[t._v("false")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("No")]),t._v(" "),s("td",[t._v("rename existing tables using "),s("code",[t._v("tableUseRealItemNames")]),t._v(" and "),s("code",[t._v("tableIdDigitCount")]),t._v(". USE WITH CARE! Deactivate after Renaming is done!")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("td",[this._v("configured per database in package "),e("code",[this._v("org.openhab.persistence.jdbc.db.*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("jdbc.minimumIdle")]),this._v(" "),e("td",[this._v("see above")]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),e("td",[this._v("see above")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("enableLogTime")]),this._v(" "),e("td",[e("code",[this._v("false")])]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),e("td",[this._v("timekeeping")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("All item- and event-related configuration is done in the file "),e("code",[this._v("persistence/jdbc.persist")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("org.eclipse.smarthome.persistence:default=jdbc\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("in the file "),e("code",[this._v("services/runtime.cfg")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"minimal-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#minimal-configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Minimal Configuration")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("url=jdbc:postgresql://192.168.0.1:5432/testPostgresql\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"migration-from-mysql-to-jdbc-persistence-services"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#migration-from-mysql-to-jdbc-persistence-services","aria-hidden":"true"}},[this._v("#")]),this._v(" Migration from MySQL to JDBC Persistence Services")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The JDBC Persistence service can act as a replacement for the MySQL Persistence service.  Here is an example of a configuration for a MySQL database named "),e("code",[this._v("testMysql")]),this._v(" with user "),e("code",[this._v("test")]),this._v(" and password "),e("code",[this._v("test")]),this._v(":")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dsl"}},[s("code",[s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("jdbc"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("mysql"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3306")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("testMysql\nuser"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("test\npassword"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("test\ntableNamePrefix"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Item")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("tableUseRealItemNames")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\ntableIdDigitCount"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Remember to install and uninstall the services you want, and rename "),e("code",[this._v("persistence/mysql.persist")]),this._v(" to "),e("code",[this._v("persistence/jdbc.persist")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"technical-notes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#technical-notes","aria-hidden":"true"}},[this._v("#")]),this._v(" Technical Notes")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"database-table-schema"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#database-table-schema","aria-hidden":"true"}},[this._v("#")]),this._v(" Database Table Schema")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("With this "),e("em",[this._v("per-item")]),this._v(" layout, the scalability and easy maintenance of the database is ensured, even if large amounts of data must be managed. To rename existing tables, use the parameters "),e("code",[this._v("tableUseRealItemNames")]),this._v(" and "),e("code",[this._v("tableIdDigitCount")]),this._v(" in the configuration.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"number-precision"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#number-precision","aria-hidden":"true"}},[this._v("#")]),this._v(" Number Precision")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("Default openHAB number items are persisted with SQL datatype "),s("code",[t._v("double")]),t._v(". Internally openHAB uses "),s("code",[t._v("BigDecimal")]),t._v(". If better numerical precision is needed, for example set "),s("code",[t._v("sqltype.NUMBER = DECIMAL(max digits, max decimals)")]),t._v(", then on the Java side, the service works with "),s("code",[t._v("BigDecimal")]),t._v(" without type conversion. If more come decimals as "),s("code",[t._v("max decimals")]),t._v(" provides, this persisted value is rounded mathematically correctly. The SQL types "),s("code",[t._v("DECIMAL")]),t._v(" or  "),s("code",[t._v("NUMERIC")]),t._v(" are precise, but to work with "),s("code",[t._v("DOUBLE")]),t._v(" is faster.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"rounding-results"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rounding-results","aria-hidden":"true"}},[this._v("#")]),this._v(" Rounding results")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("The results of database queries of number items are rounded to three decimal places by default. With "),s("code",[t._v("numberDecimalcount")]),t._v(" decimals can be changed. Especially if sql types "),s("code",[t._v("DECIMAL")]),t._v(" or  "),s("code",[t._v("NUMERIC")]),t._v(" are used for "),s("code",[t._v("sqltype.NUMBER")]),t._v(", rounding can be disabled by setting "),s("code",[t._v("numberDecimalcount=-1")]),t._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"for-developers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#for-developers","aria-hidden":"true"}},[this._v("#")]),this._v(" For Developers")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("Clearly separated source files for the database-specific part of openHAB logic.")]),this._v(" "),e("li",[this._v("Code duplication by similar services is prevented.")]),this._v(" "),e("li",[this._v("Integrating a new SQL and JDBC enabled database is fairly simple.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"performance-tests"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#performance-tests","aria-hidden":"true"}},[this._v("#")]),this._v(" Performance Tests")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",[s("thead",[s("tr",[s("th",[t._v("DATABASE")]),t._v(" "),s("th",{staticStyle:{"text-align":"right"}},[t._v("FIRST RUN")]),t._v(" "),s("th",{staticStyle:{"text-align":"right"}},[t._v("AVERAGE")]),t._v(" "),s("th",{staticStyle:{"text-align":"right"}},[t._v("FASTEST")]),t._v(" "),s("th",{staticStyle:{"text-align":"right"}},[t._v("SIZE AFTER")]),t._v(" "),s("th",[t._v("COMMENT")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("Derby")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("7.829")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("6.892")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("5.381")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("5.36 MB")]),t._v(" "),s("td",[t._v("local embedded")])]),t._v(" "),s("tr",[s("td",[t._v("H2")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("1.797")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("2.080")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("1.580")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("0.96 MB")]),t._v(" "),s("td",[t._v("local embedded")])]),t._v(" "),s("tr",[s("td",[t._v("hsqldb")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("3.474")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("2.104")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("1.310")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("1.23 MB")]),t._v(" "),s("td",[t._v("local embedded")])]),t._v(" "),s("tr",[s("td",[t._v("mysql")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("11.873")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("11.524")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("10.971")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("-")]),t._v(" "),s("td",[t._v("ext. Server VM")])]),t._v(" "),s("tr",[s("td",[t._v("postgresql")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("8.147")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("7.072")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("6.895")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("-")]),t._v(" "),s("td",[t._v("ext. Server VM")])]),t._v(" "),s("tr",[s("td",[t._v("sqlite")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("2.406")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("1.249")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("1.137")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("0.28 MB")]),t._v(" "),s("td",[t._v("local embedded")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("Each test ran about 20 Times every 30 seconds.")]),this._v(" "),e("li",[this._v("openHAB 1.x has ready started for about a Minute.")]),this._v(" "),e("li",[this._v("the data in seconds for the evaluation are from the console output.")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-rules"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("rule")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DB STRESS TEST"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("when")]),t._v(" \n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Time cron")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30 * * * * ?"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\tcount "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" count"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("23")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("postUpdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" NUMBERITEM"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token function-name"}},[t._v("SWITCHITEM")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("previousState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("postUpdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" DIMMERITEM"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("OFF")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token function-name"}},[t._v("NUMBERITEM")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("changedSince")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("minusMinutes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("postUpdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" DIMMERITEM"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])])}],!1,null,null,null);e.default=r.exports}}]);