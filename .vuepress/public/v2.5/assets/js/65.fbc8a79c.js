(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{409:function(t,e,s){t.exports=s.p+"assets/img/event-admin.861f6dbd.png"},503:function(t,e,s){"use strict";s.r(e);var n=[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"introduction"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#introduction","aria-hidden":"true"}},[this._v("#")]),this._v(" Introduction")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("em",[this._v("This pattern decouples sources from their handlers by interposing an event channel between them.\nThe publisher posts events to the channel, which identifies which handlers need to be notified and then takes care of the notification process.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Both publishers and subscribers can disappear at any time.\nA central module to track the handlers availability is needed - the "),e("em",[this._v("Event Admin Service")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"event-admin-service"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#event-admin-service","aria-hidden":"true"}},[this._v("#")]),this._v(" Event Admin Service")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("The "),s("em",[t._v("Event Admin Service")]),t._v(" ("),s("code",[t._v("org.osgi.service.event.EventAdmin")]),t._v(") takes a central place in the communication between "),s("em",[t._v("Event Publishers")]),t._v(" and subscribers ("),s("em",[t._v("Event Listeners")]),t._v(").\nIt is responsible for keeping track of the listeners, and sending events to them.\nIt supports both synchronous and asynchronous sending that will be reviewed in more details in the "),s("a",{attrs:{href:"#send-events"}},[t._v("section about sending events")]),t._v(".\nBut let's illustrate that with the following picture:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(409),alt:"Bundle lifecycle"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"event"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#event","aria-hidden":"true"}},[this._v("#")]),this._v(" Event")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("The "),e("em",[this._v("Event")]),this._v(" interface("),e("code",[this._v("org.osgi.service.event.Event")]),this._v(") encapsulates a single message. It contains:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("topic - used from the "),e("em",[this._v("Event Admin Service")]),this._v(" as a filter to dispatch the events only to the listeners that are interested;")]),this._v(" "),e("li",[this._v("payload - the information that we would like to send. It is represented by a key-value pair.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"receive-events"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#receive-events","aria-hidden":"true"}},[this._v("#")]),this._v(" Receive Events")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("In order to receive an event through the "),e("em",[this._v("Event Admin Service")]),this._v(" we have to register a service that implements the "),e("code",[this._v("org.osgi.service.event.EventHandler")]),this._v(" interface.\nA property "),e("em",[this._v("event.topics")]),this._v(" must be defined that contains all topics that we are interested in.")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("osgi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Event")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("osgi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EventHandler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("osgi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LogService")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("slf4j")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Logger")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("slf4j")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoggerFactory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("service "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LogEventHandler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EventHandler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" property "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"event.topics=*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LogEventHandler")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EventHandler")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Logger")]),t._v(" logger "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoggerFactory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLogger")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getClass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleEvent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Event")]),t._v(" event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" Recevied event with topic: {}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTopic")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("You can register a handler for multiple topics by separating them by comma: "),e("code",[this._v("event.topics=some/topic,other/topic")])]),this._v(" "),e("li",[this._v("You can register for all events with "),e("code",[this._v("*")]),this._v(".")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"send-events"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#send-events","aria-hidden":"true"}},[this._v("#")]),this._v(" Send Events")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("As we have already mentioned, you will need an "),e("em",[this._v("Event Admin Service")]),this._v(" implementation to send events.\nIn Equinox the service is implemented in the "),e("code",[this._v("org.eclipse.equinox.event")]),this._v(" bundle.\nThe service contains two methods for sending events:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("code",[this._v("void postEvent(Event event)")]),this._v(" - sends an Event asynchronously;")]),this._v(" "),e("li",[e("code",[this._v("void sendEvent(Event event)")]),this._v(" - sends an Event synchronously;")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"further-reading"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#further-reading","aria-hidden":"true"}},[this._v("#")]),this._v(" Further Reading")])}],a=s(0),r=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),s("p",[t._v("In a dynamic environment like OSGi, communication with events has a wide variety of use cases.\nA lot of core services share information using events, so understanding how to use events in OSGi is fundamental.")]),t._v(" "),s("p",[t._v("OSGi events are based on the publish-subscribe messaging pattern.\nLet's use the definition for the pattern that can be found in the "),s("a",{attrs:{href:"https://osgi.org/download/r7/osgi.cmpn-7.0.0.pdf",target:"_blank",rel:"noopener noreferrer"}},[t._v("OSGi Compendium Release 7"),s("OutboundLink")],1),t._v(":")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),s("p",[t._v("Fig.1 Event Admin Service (Source: "),s("a",{attrs:{href:"http://enroute.osgi.org/img/services/org.osgi.service.event.overview.png",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://enroute.osgi.org/img/services/org.osgi.service.event.overview.png"),s("OutboundLink")],1),t._v(")")]),t._v(" "),s("p",[t._v("Before going into more details, let's take a look at the events.")]),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://osgi.org/download/r7/osgi.cmpn-7.0.0.pdf",target:"_blank",rel:"noopener noreferrer"}},[t._v("OSGi Compendium Release 7"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"http://enroute.osgi.org/services/org.osgi.service.event.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://enroute.osgi.org/services/org.osgi.service.event.html"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"http://blog.vogella.com/2017/05/16/osgi-event-admin-publish-subscribe/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://blog.vogella.com/2017/05/16/osgi-event-admin-publish-subscribe/"),s("OutboundLink")],1)])]),t._v(" "),s("DocPreviousVersions"),t._v(" "),s("EditPageLink")],1)},n,!1,null,null,null);e.default=r.exports}}]);