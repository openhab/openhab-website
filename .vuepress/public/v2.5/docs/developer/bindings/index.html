<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Bindings | openHAB</title>
    <meta name="description" content="openHAB - a vendor and technology agnostic open source automation software for your home">
    <link rel="stylesheet" href="/v2.5/fonts/fonts.css">
  <link rel="icon" href="/v2.5/favicon.ico">
  <link rel="shortcut icon" href="/v2.5/favicon.ico">
  <link rel="apple-touch-icon" href="/v2.5/apple-icon.png">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://www.openhab.org/og-image.png">
    <meta property="og:title" content="Bindings"><meta property="og:description" content="a vendor and technology agnostic open source automation software for your home">
    <link rel="preload" href="/v2.5/assets/css/0.styles.17119d73.css" as="style"><link rel="preload" href="/v2.5/assets/js/app.6e1f6232.js" as="script"><link rel="preload" href="/v2.5/assets/js/26.3a17d104.js" as="script"><link rel="preload" href="/v2.5/assets/js/32.7c8f01a5.js" as="script"><link rel="preload" href="/v2.5/assets/js/33.df59480d.js" as="script">
    <link rel="stylesheet" href="/v2.5/assets/css/0.styles.17119d73.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/v2.5/" class="home-link router-link-active"><img src="/v2.5/openhab-logo.png" alt="openHAB" class="logo"> <span class="site-name can-hide">openHAB</span></a> <div class="links" style="max-width:nullpx;"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/v2.5/blog/" class="nav-link">Blog</a></div><div class="nav-item"><a href="/v2.5/download/" class="nav-link">Download</a></div><div class="nav-item"><a href="/v2.5/docs/" class="nav-link router-link-active">Documentation</a></div><div class="nav-item"><a href="/v2.5/addons/" class="nav-link">Add-ons</a></div><div class="nav-item"><a href="/v2.5/community/" class="nav-link">Community</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">About</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Get Involved</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/v2.5/about/who-we-are.html" class="nav-link">Who We Are</a></li><li class="dropdown-subitem"><a href="/v2.5/about/contributing.html" class="nav-link">Contribute</a></li><li class="dropdown-subitem"><a href="/v2.5/about/events.html" class="nav-link">Events</a></li></ul></li><li class="dropdown-item"><h4>Support openHAB</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://openhabfoundation.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Foundation
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="/v2.5/about/donate.html" class="nav-link">Donate</a></li></ul></li><li class="dropdown-item"><h4>Resources</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/v2.5/about/showcase.html" class="nav-link">Showcase/How-tos</a></li><li class="dropdown-subitem"><a href="/v2.5/privacy.html" class="nav-link">Privacy Policy</a></li><li class="dropdown-subitem"><a href="https://www.myopenhab.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  myopenHAB
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/openhab" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/v2.5/blog/" class="nav-link">Blog</a></div><div class="nav-item"><a href="/v2.5/download/" class="nav-link">Download</a></div><div class="nav-item"><a href="/v2.5/docs/" class="nav-link router-link-active">Documentation</a></div><div class="nav-item"><a href="/v2.5/addons/" class="nav-link">Add-ons</a></div><div class="nav-item"><a href="/v2.5/community/" class="nav-link">Community</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">About</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Get Involved</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/v2.5/about/who-we-are.html" class="nav-link">Who We Are</a></li><li class="dropdown-subitem"><a href="/v2.5/about/contributing.html" class="nav-link">Contribute</a></li><li class="dropdown-subitem"><a href="/v2.5/about/events.html" class="nav-link">Events</a></li></ul></li><li class="dropdown-item"><h4>Support openHAB</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://openhabfoundation.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Foundation
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="/v2.5/about/donate.html" class="nav-link">Donate</a></li></ul></li><li class="dropdown-item"><h4>Resources</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/v2.5/about/showcase.html" class="nav-link">Showcase/How-tos</a></li><li class="dropdown-subitem"><a href="/v2.5/privacy.html" class="nav-link">Privacy Policy</a></li><li class="dropdown-subitem"><a href="https://www.myopenhab.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  myopenHAB
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/openhab" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Welcome to openHAB</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/v2.5/docs/" class="sidebar-link">Introduction</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Concepts</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/v2.5/docs/concepts/" class="sidebar-link">Concepts Overview</a></li><li><a href="/v2.5/docs/concepts/things.html" class="sidebar-link">Things</a></li><li><a href="/v2.5/docs/concepts/items.html" class="sidebar-link">Items</a></li><li><a href="/v2.5/docs/concepts/discovery.html" class="sidebar-link">Thing Discovery</a></li><li><a href="/v2.5/docs/concepts/audio.html" class="sidebar-link">Audio &amp; Voice</a></li><li><a href="/v2.5/docs/concepts/units-of-measurement.html" class="sidebar-link">Units Of Measurement</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Installation Guide</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/v2.5/docs/installation/" class="sidebar-link">Installation Overview</a></li><li><a href="/v2.5/docs/installation/linux.html" class="sidebar-link">Linux</a></li><li><a href="/v2.5/docs/installation/windows.html" class="sidebar-link">Windows</a></li><li><a href="/v2.5/docs/installation/macos.html" class="sidebar-link">macOS</a></li><li><a href="/v2.5/docs/installation/openhabian.html" class="sidebar-link">openHABian</a></li><li><a href="/v2.5/docs/installation/rasppi.html" class="sidebar-link">Raspberry Pi</a></li><li><a href="/v2.5/docs/installation/pine.html" class="sidebar-link">PINE A64</a></li><li><a href="/v2.5/docs/installation/docker.html" class="sidebar-link">Docker</a></li><li><a href="/v2.5/docs/installation/synology.html" class="sidebar-link">Synology DiskStation</a></li><li><a href="/v2.5/docs/installation/qnap.html" class="sidebar-link">QNAP NAS</a></li><li><a href="/v2.5/docs/installation/security.html" class="sidebar-link">Security</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>New User Tutorial</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/v2.5/docs/tutorial/" class="sidebar-link">Tutorial Overview</a></li><li><a href="/v2.5/docs/tutorial/1sttimesetup.html" class="sidebar-link">First-time setup of openHAB</a></li><li><a href="/v2.5/docs/tutorial/uis.html" class="sidebar-link">openHAB UIs</a></li><li><a href="/v2.5/docs/tutorial/configuration.html" class="sidebar-link">Configuration of openHAB</a></li><li><a href="/v2.5/docs/tutorial/sitemap.html" class="sidebar-link">Creating a sitemap</a></li><li><a href="/v2.5/docs/tutorial/rules.html" class="sidebar-link">Working with rules and scripts</a></li><li><a href="/v2.5/docs/tutorial/logs.html" class="sidebar-link">Looking to the logs</a></li><li><a href="/v2.5/docs/tutorial/persistence.html" class="sidebar-link">Persistence</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Configuration Guide</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/v2.5/docs/configuration/" class="sidebar-link">Configuration Overview</a></li><li><a href="/v2.5/docs/configuration/addons.html" class="sidebar-link">Installation of Add-ons</a></li><li><a href="/v2.5/docs/configuration/things.html" class="sidebar-link">Things</a></li><li><a href="/v2.5/docs/configuration/items.html" class="sidebar-link">Items</a></li><li><a href="/v2.5/docs/configuration/sitemaps.html" class="sidebar-link">Sitemaps</a></li><li><a href="/v2.5/docs/configuration/persistence.html" class="sidebar-link">Persistence</a></li><li><a href="/v2.5/docs/configuration/rules-dsl.html" class="sidebar-link">Rules</a></li><li><a href="/v2.5/docs/configuration/transformations.html" class="sidebar-link">Transformation Services</a></li><li><a href="/v2.5/docs/configuration/actions.html" class="sidebar-link">Actions</a></li><li><a href="/v2.5/docs/configuration/iconsets/classic/" class="sidebar-link">Icons</a></li><li><a href="/v2.5/docs/configuration/jsr223.html" class="sidebar-link">JSR223 Scripting</a></li><li><a href="/v2.5/docs/configuration/services.html" class="sidebar-link">Services</a></li><li><a href="/v2.5/docs/configuration/multimedia.html" class="sidebar-link">Multimedia</a></li><li><a href="/v2.5/docs/configuration/migration/" class="sidebar-link">Migration from 1.x</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Interfaces and Ecosystem</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/v2.5/docs/configuration/packages.html" class="sidebar-link">Initial Setup - Package Selection</a></li><li><a href="/v2.5/docs/configuration/editors.html" class="sidebar-link">Editors</a></li><li><a href="/v2.5/docs/configuration/homebuilder.html" class="sidebar-link">Home Builder</a></li><li><a href="/v2.5/docs/configuration/paperui.html" class="sidebar-link">Paper UI</a></li><li><a href="/v2.5/docs/configuration/ui/habmin/" class="sidebar-link">HABmin</a></li><li><a href="/v2.5/docs/configuration/ui/habot/" class="sidebar-link">HABot</a></li><li><a href="/v2.5/docs/configuration/habpanel.html" class="sidebar-link">HABPanel</a></li><li><a href="/v2.5/docs/configuration/ui/basic/" class="sidebar-link">Basic UI</a></li><li><a href="/v2.5/docs/configuration/ui/classic/" class="sidebar-link">Classic UI</a></li><li><a href="/v2.5/docs/configuration/rules-ng.html" class="sidebar-link">Next-Gen Rules</a></li><li><a href="/v2.5/docs/configuration/eclipseiotmarket.html" class="sidebar-link">Eclipse IoT Marketplace</a></li><li><a href="/v2.5/docs/configuration/restdocs.html" class="sidebar-link">REST API</a></li><li><a href="/v2.5/docs/apps/android.html" class="sidebar-link">Android App</a></li><li><a href="/v2.5/docs/apps/ios.html" class="sidebar-link">iOS App</a></li><li><a href="/v2.5/docs/apps/windows.html" class="sidebar-link">Windows 10 App</a></li><li><a href="/v2.5/docs/ecosystem/alexa/" class="sidebar-link">Amazon Alexa</a></li><li><a href="/v2.5/docs/ecosystem/google-assistant/" class="sidebar-link">Google Assistant</a></li><li><a href="/v2.5/addons/integrations/homekit/" class="sidebar-link">Apple HomeKit</a></li><li><a href="/v2.5/docs/ecosystem/ifttt/" class="sidebar-link">IFTTT</a></li><li><a href="/v2.5/docs/ecosystem/mycroft/" class="sidebar-link">Mycroft.AI</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Administration Guide</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/v2.5/docs/administration/" class="sidebar-link">Advanced Functionality and Administrative Tasks</a></li><li><a href="/v2.5/docs/administration/console.html" class="sidebar-link">The Console</a></li><li><a href="/v2.5/docs/administration/runtime.html" class="sidebar-link">Runtime Commands</a></li><li><a href="/v2.5/docs/administration/bundles.html" class="sidebar-link">Bundle Management</a></li><li><a href="/v2.5/docs/administration/logging.html" class="sidebar-link">Logging</a></li><li><a href="/v2.5/docs/administration/jsondb.html" class="sidebar-link">JsonDB Storage</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Developer Guide</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/v2.5/docs/developer/" class="sidebar-link">Overview &amp; Introduction </a></li><li><a href="/v2.5/docs/developer/guidelines.html" class="sidebar-link">Coding Guidelines</a></li><li><a href="/v2.5/docs/developer/bindings/" class="active sidebar-link">Bindings</a></li><li><a href="/v2.5/docs/developer/module-types/" class="sidebar-link">Automation Modules</a></li><li><a href="/v2.5/docs/developer/transformations/" class="sidebar-link">Transformations / Profiles</a></li><li><a href="/v2.5/docs/developer/ioservices/" class="sidebar-link">IO Services</a></li><li><a href="/v2.5/docs/developer/persistence/" class="sidebar-link">Persistence Service</a></li><li><a href="/v2.5/docs/developer/audio/" class="sidebar-link">Audio &amp; Voice</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Developer Appendix</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/v2.5/docs/developer/buildsystem.html" class="sidebar-link">Build System</a></li><li><a href="/v2.5/docs/developer/osgi/osgi.html" class="sidebar-link">OSGi</a></li><li><a href="/v2.5/docs/developer/utils/tools.html" class="sidebar-link">Framework Tools</a></li><li><a href="/v2.5/docs/developer/utils/i18n.html" class="sidebar-link">Internationalization</a></li><li><a href="/v2.5/docs/developer/utils/events.html" class="sidebar-link">Event Bus</a></li><li><a href="/v2.5/docs/developer/tests.html" class="sidebar-link">Writing tests</a></li><li><a href="/v2.5/docs/developer/contributing.html" class="sidebar-link">Contribution</a></li><li><a href="/v2.5/docs/developer/governance.html" class="sidebar-link">Governance</a></li><li><a href="/v2.5/docs/developer/legacy/compatibilitylayer.html" class="sidebar-link">Compatibility Layer</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="developing-a-binding"><a href="#developing-a-binding" aria-hidden="true" class="header-anchor">#</a> Developing a Binding</h1> <p>A binding is an extension to openHAB that integrates an external system like a software service or a hardware device.
The external system is represented as a set of <em>Things</em> and sometimes <em>Bridges</em> with <em>Channels</em>.</p> <p>This chapter covers everything to know about binding development.
It makes sense to briefly read over all sections to make you familiar with what the framework has to offer.</p> <p><img src="/v2.5/assets/img/concept.166bfd1a.png" alt="thing concept"></p> <p>During development you might come back with specific questions.</p> <p></p><div class="table-of-contents"><ul><li><a href="#structure-of-a-binding">Structure of a Binding</a></li><li><a href="#describing-things">Describing Things</a></li><li><a href="#the-thinghandlerfactory">The ThingHandlerFactory</a></li><li><a href="#the-thinghandler">The ThingHandler</a><ul><li><a href="#lifecycle">Lifecycle</a></li><li><a href="#configuration">Configuration</a></li><li><a href="#properties">Properties</a></li><li><a href="#handling-commands">Handling Commands</a></li><li><a href="#handling-refreshtype-command">Handling RefreshType Command</a></li><li><a href="#updating-the-channel-state">Updating the Channel State</a></li><li><a href="#polling-for-a-state">Polling for a State</a></li><li><a href="#trigger-a-channel">Trigger a channel</a></li><li><a href="#updating-the-thing-status">Updating the Thing Status</a></li><li><a href="#channel-links">Channel Links</a></li></ul></li><li><a href="#updating-the-thing-from-a-binding">Updating the Thing from a Binding</a><ul><li><a href="#updating-the-configuration">Updating the Configuration</a></li><li><a href="#updating-thing-properties">Updating Thing Properties</a></li><li><a href="#updating-the-thing-structure">Updating the Thing Structure</a></li><li><a href="#handling-thing-updates">Handling Thing Updates</a></li></ul></li><li><a href="#bridges">Bridges</a><ul><li><a href="#bridge-handler-implementation">Bridge Handler Implementation</a></li><li><a href="#the-basebridgehandler">The BaseBridgeHandler</a></li><li><a href="#life-cycle">Life cycle</a></li><li><a href="#handler-initialization-notification">Handler initialization notification</a></li></ul></li><li><a href="#config-status-provider">Config Status Provider</a><ul><li><a href="#providing-the-configuration-status">Providing the Configuration Status</a></li></ul></li><li><a href="#handling-thing-bridge-removal">Handling Thing / Bridge Removal</a></li><li><a href="#actions-bound-to-a-thing">Actions bound to a Thing</a></li><li><a href="#firmware-information-firmware-update">Firmware information / Firmware update</a></li><li><a href="#implementing-a-discovery-service">Implementing a Discovery Service</a><ul><li><a href="#registering-as-an-osgi-service">Registering as an OSGi service</a></li><li><a href="#background-discovery">Background Discovery</a></li><li><a href="#active-scan">Active Scan</a></li><li><a href="#re-discovered-results-and-things">Re-Discovered Results and Things</a></li><li><a href="#remove-older-results">Remove older results</a></li><li><a href="#upnp-discovery">UPnP Discovery</a></li><li><a href="#mdns-discovery">mDNS Discovery</a></li><li><a href="#discovery-that-is-bound-to-a-thing">Discovery that is bound to a Thing</a></li></ul></li><li><a href="#frequently-asked-questions-faq">Frequently asked questions / FAQ</a></li><li><a href="#include-the-binding-in-the-build">Include the Binding in the Build</a></li></ul></div><p></p> <h2 id="structure-of-a-binding"><a href="#structure-of-a-binding" aria-hidden="true" class="header-anchor">#</a> Structure of a Binding</h2> <p>Every binding needs to define a <code>binding.xml</code> file.
Find more information in the respective <a href="/v2.5/docs/developer/bindings/binding-xml.html">binding XML reference</a>.</p> <h2 id="describing-things"><a href="#describing-things" aria-hidden="true" class="header-anchor">#</a> Describing Things</h2> <p>External systems are represented as <em>Things</em> in openHAB.
When starting the implementation of a binding, you should think about the abstraction of your external system.
Different services or devices should be represented as individual <em>Things</em>.
Each functionality of the <em>Thing</em> should be modelled as a <code>Channel</code>.</p> <p><em>Thing</em> and <em>Channel</em> structures need to be explained to the openHAB runtime.
This is done in a declarative way via XML files, so called <em>ThingTypes</em> and <em>ChannelTypes</em>.</p> <p>Find more information in the respective <a href="/v2.5/docs/developer/bindings/thing-xml.html">Thing &amp; Channel XML reference</a>.</p> <h2 id="the-thinghandlerfactory"><a href="#the-thinghandlerfactory" aria-hidden="true" class="header-anchor">#</a> The ThingHandlerFactory</h2> <p>For each <em>Thing</em> the binding must provide a proper <code>ThingHandler</code> implementation that is able to handle the communication.</p> <p>The <code>ThingHandlerFactory</code> is responsible for creating <code>ThingHandler</code> instances.</p> <p>Every binding must implement a <code>ThingHandlerFactory</code> and register it as OSGi service so that the runtime knows which class needs to be called for creating and handling things.</p> <p>When a new <em>Thing</em> is added, the openHAB runtime queries every <code>ThingHandlerFactory</code> for support of the <em>ThingType</em> by calling the <code>supportsThingType</code> method.
When the method returns <code>true</code>, the runtime calls <code>createHandler</code>, which should then return a proper <code>ThingHandler</code> implementation.</p> <p>A weather bindings <code>WeatherHandlerFactory</code> for example supports only one <em>ThingType</em> and instantiates a new <code>WeatherHandler</code> for a given thing:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@NonNullByDefault</span>
<span class="token annotation punctuation">@Component</span><span class="token punctuation">(</span>configurationPid <span class="token operator">=</span> <span class="token string">&quot;binding.myweatherbinding&quot;</span><span class="token punctuation">,</span> service <span class="token operator">=</span> <span class="token class-name">ThingHandlerFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WeatherHandlerFactory</span> <span class="token keyword">extends</span> <span class="token class-name">BaseThingHandlerFactory</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ThingTypeUID</span><span class="token punctuation">&gt;</span></span> SUPPORTED_THING_TYPES_UIDS <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token class-name">WeatherBindingConstants</span><span class="token punctuation">.</span>THING_TYPE_WEATHER<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supportsThingType</span><span class="token punctuation">(</span><span class="token class-name">ThingTypeUID</span> thingTypeUID<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> SUPPORTED_THING_TYPES_UIDS<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>thingTypeUID<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ThingHandler</span> <span class="token function">createHandler</span><span class="token punctuation">(</span><span class="token class-name">Thing</span> thing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThingTypeUID</span> thingTypeUID <span class="token operator">=</span> thing<span class="token punctuation">.</span><span class="token function">getThingTypeUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">WeatherBindingConstants</span><span class="token punctuation">.</span>THING_TYPE_WEATHER<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>thingTypeUID<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WeatherHandler</span><span class="token punctuation">(</span>thing<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Constants like the <code>THING_TYPE_WEATHER</code> UID and also <em>Channel</em> UIDs are typically defined inside a public <code>BindingConstants</code> class.</p> <p>Depending on your implementation, each <em>ThingType</em> may use its own handler.
It is also possible to use the same handler for different <em>Things</em>, or use different handlers for the same <em>ThingType</em>, depending on the configuration.</p> <h2 id="the-thinghandler"><a href="#the-thinghandler" aria-hidden="true" class="header-anchor">#</a> The ThingHandler</h2> <p>A <code>ThingHandler</code> handles the communication between openHAB and an entity from the real world, e.g. a physical device, a web service, represented by a <code>Thing</code>.</p> <p>openHAB provides an abstract base class named <code>BaseThingHandler</code>.
It is recommended to use this class, because it covers a lot of common logic.
Most of the explanations are based on the assumption, that the binding inherits from the BaseThingHandler in all concrete <code>ThingHandler</code> implementations.
Nevertheless if there are reasons why you can not use the base class, the binding can also directly implement the <code>ThingHandler</code> interface.</p> <p>The communication between the framework and the ThingHandler is bidirectional.</p> <p>If the framework wants the binding to do something or just notfiy it about changes,
it calls methods like <code>handleCommand</code>, <code>handleUpdate</code> or <code>thingUpdated</code>.</p> <p>If the ThingHandler wants to inform the framework about changes, it uses a callback
The <code>BaseThingHandler</code> provides convience methods like <code>updateState</code>, <code>updateStatus</code> <code>updateThing</code> or <code>triggerChannel</code>, that can be used to inform the framework about changes.</p> <p>The overall structure looks like this:</p> <div class="language-java extra-class"><pre class="language-java"><code>TODO
</code></pre></div><h3 id="lifecycle"><a href="#lifecycle" aria-hidden="true" class="header-anchor">#</a> Lifecycle</h3> <p>The <code>ThingHandler</code> has two important lifecycle methods: <code>initialize</code> and <code>dispose</code>.
The <code>initialize</code> method is called when the handler is started and <code>dispose</code> just before the handler is stopped.
Therefore these methods can be used to allocate and deallocate resources.
For an example, our exemplary Weather binding starts and stops a scheduled job to update weather information within these methods.</p> <h4 id="startup"><a href="#startup" aria-hidden="true" class="header-anchor">#</a> Startup</h4> <p>The startup of a handler is divided in two essential steps:</p> <ol><li><p>Handler is registered: <code>ThingHandler</code> instance is created by a <code>ThingHandlerFactory</code> and tracked by the framework.
In addition, the handler can be registered as a service if required, e.g. as <code>FirmwareUpdateHandler</code> or <code>ConfigStatusProvider</code>.</p></li> <li><p>Handler is initialized: <code>ThingHandler.initialize()</code> is called by the framework in order to initialize the handler.
This method is only called if all 'required' configuration parameters of the Thing are present.
The handler is ready to work (methods like <code>handleCommand</code>, <code>handleUpdate</code> or <code>thingUpdated</code> can be called).</p></li></ol> <p>The diagram below illustrates the startup of a handler in more detail.
The life cycle is controlled by the <code>ThingManager</code>.</p> <p><img src="/v2.5/assets/img/thing_life_cycle_startup.5f9f79f7.png" alt="thing_life_cycle_startup"></p> <p>The <code>ThingManager</code> mediates the communication between a <code>Thing</code> and a <code>ThingHandler</code> from the binding.
The <code>ThingManager</code> creates for each Thing a <code>ThingHandler</code> instance using a <code>ThingHandlerFactory</code>.
Therefore, it tracks all <code>ThingHandlerFactory</code>s from the binding.</p> <p>The <code>ThingManager</code> determines if the <code>Thing</code> is initializable or not.
A <code>Thing</code> is considered as <em>initializable</em> if all <em>required</em> configuration parameters (cf. property <em>parameter.required</em> in <a href="/v2.5/docs/developer/bindings/config-xml.html">Configuration Description</a>) are available.
If so, the method <code>ThingHandler.initialize()</code> is called.</p> <p>Only Things with status (cf. <a href="/v2.5/docs/concepts/things.html#thing-status">Thing Status</a>) <em>UNKNOWN</em>, <em>ONLINE</em> or <em>OFFLINE</em> are considered as <em>initialized</em> by the framework and therefore it is the handler's duty to assign one of these states sooner or later.
To achieve that, the status must be reported to the framework via the callback or <code>BaseThingHandler.updateStatus(...)</code> for convenience.
Furthermore, the framework expects <code>initialize()</code> to be non-blocking and to return quickly.
For longer running initializations, the implementation has to take care of scheduling a separate job which must guarantee to set the status eventually.
Also, please note that the framework expects the <code>initialize()</code> method to handle anticipated error situations gracefully and set the thing to <em>OFFLINE</em> with the corresponding status detail (e.g. <em>COMMUNICATION_ERROR</em> or <em>CONFIGURATION_ERROR</em> including a meaningful description) instead of throwing exceptions.</p> <p>If the <code>Thing</code> is not initializable the configuration can be updated via <code>ThingHandler.handleConfigurationUpdate(Map)</code>.
The binding has to notify the <code>ThingManager</code> about the updated configuration by a callback.
The <code>ThingManager</code> tries to initialize the <code>ThingHandler</code> resp. <code>Thing</code> again.</p> <p>After the handler is initialized, the handler must be ready to handle methods calls like <code>handleCommand</code> and <code>handleUpdate</code>, as well as <code>thingUpdated</code>.</p> <h4 id="shutdown"><a href="#shutdown" aria-hidden="true" class="header-anchor">#</a> Shutdown</h4> <p>The shutdown of a handler is also divided in two essential steps:</p> <ol><li><p>Handler is unregistered: <code>ThingHandler</code> instance is no longer tracked by the framework.
The <code>ThingHandlerFactory</code> can unregister handler services (e.g. <code>FirmwareUpdateHandler</code> or <code>ConfigStatusProvider</code>) if registered, or release resources.</p></li> <li><p>Handler is disposed: <code>ThingHandler.disposed()</code> method is called.
The framework expects <code>dispose()</code> to be non-blocking and to return quickly.
For longer running disposals, the implementation has to take care of scheduling a separate job.</p></li></ol> <p><img src="/v2.5/assets/img/thing_life_cycle_shutdown.537f1d19.png" alt="thing_life_cycle_shutdown"></p> <p>After the handler is disposed, the framework will not call the handler anymore.</p> <h4 id="bridge-status-changes"><a href="#bridge-status-changes" aria-hidden="true" class="header-anchor">#</a> Bridge Status Changes</h4> <p>A <code>ThingHandler</code> is notified about Bridge status changes to <em>ONLINE</em> and <em>OFFLINE</em> after a <code>BridgeHandler</code> has been initialized.
Therefore, the method <code>ThingHandler.bridgeStatusChanged(ThingStatusInfo)</code> must be implemented
(this method is not called for a bridge status updated through the bridge initialization itself).
If the Thing of this handler does not have a Bridge, this method is never called.</p> <p>If the bridge status has changed to OFFLINE, the status of the handled thing must also be updated to <em>OFFLINE</em> with detail <em>BRIDGE_OFFLINE</em>.
If the bridge returns to <em>ONLINE</em>, the thing status must be changed at least to <em>OFFLINE</em> with detail <em>NONE</em> or to another thing specific status.</p> <h3 id="configuration"><a href="#configuration" aria-hidden="true" class="header-anchor">#</a> Configuration</h3> <p><em>Things</em> can be configured with parameters.
To retrieve the configuration of a <em>Thing</em> one can call <code>getThing().getConfiguration()</code> inside the <code>ThingHandler</code>.
The configuration class has the equivalent methods as the <code>Map</code> interface, thus the method <code>get(String key)</code> can be used to retrieve a value for a given key.</p> <p>Moreover the configuration class has a utility method <code>as(Class&lt;T&gt; configurationClass)</code> that transforms the configuration into a Java object of the given type.</p> <p>All configuration values will be mapped to properties of the class.
The type of the property must match the type of the configuration.
Only the following types are supported for configuration values: <code>Boolean</code>, <code>String</code> and <code>BigDecimal</code>.</p> <p>For example, the Yahoo Weather binding allows configuration of the location and the refresh frequency.</p> <h3 id="properties"><a href="#properties" aria-hidden="true" class="header-anchor">#</a> Properties</h3> <p><em>Things</em> can have properties.
If you would like to add meta data to your thing, e.g. the vendor of the thing, then you can define your own thing properties by simply adding them to the thing type definition.
The properties section <a href="/v2.5/docs/developer/bindings/thing-definition.html#Properties">here</a> explains how to specify such properties.</p> <p>To retrieve the properties one can call the operation <code>getProperties</code> of the corresponding <code>org.eclipse.smarthome.core.thing.type.ThingType</code> instance.
If a thing will be created for this thing type then its properties will be automatically copied into the new thing instance.
Therefore the <code>org.eclipse.smarthome.core.thing.Thing</code> interface also provides the <code>getProperties</code> operation to retrieve the defined properties.
In contrast to the <code>getProperties</code> operation of the thing type instance the result of the thing´s <code>getProperties</code> operation will also contain the properties updated during runtime (cp. the thing handler <a href="/v2.5/docs/developer/bindings/thing-handler.html">documentation</a>).</p> <h3 id="handling-commands"><a href="#handling-commands" aria-hidden="true" class="header-anchor">#</a> Handling Commands</h3> <p>For handling commands the <code>ThingHandler</code> interface defines the <code>handleCommand</code> method.
This method is called when a command is sent to an item, which is linked to a channel of the <em>Thing</em>.
A Command represents the intention that an action should be executed on the external system,
or that the state should be changed.
Inside the <code>handleCommand</code> method binding specific logic can be executed.</p> <p>The ThingHandler implementation must be prepared to</p> <ul><li>handle different command types depending on the item types, that are defined by the channels,</li> <li>be called at the same time from different threads.</li></ul> <p>If an exception is thrown in the method, it will be caught by the framework and logged as an error.
So it is better to handle communication errors within the binding and to update the thing status accordingly.</p> <p>The following code block shows a typical implementation of the <code>handleCommand</code> method:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleCommand</span><span class="token punctuation">(</span><span class="token class-name">ChannelUID</span> channelUID<span class="token punctuation">,</span> <span class="token class-name">Command</span> command<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
    	<span class="token keyword">switch</span> <span class="token punctuation">(</span>channelUID<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	    	<span class="token keyword">case</span> CHANNEL_TEMPERATURE<span class="token operator">:</span>
	        	<span class="token keyword">if</span><span class="token punctuation">(</span>command <span class="token keyword">instanceof</span> <span class="token class-name">OnOffType</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	        		<span class="token comment">// binding specific logic goes here</span>
	        		<span class="token class-name">SwitchState</span> deviceSwitchState <span class="token operator">=</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">OnOffType</span><span class="token punctuation">)</span> command<span class="token punctuation">)</span><span class="token punctuation">;</span>
	        		<span class="token function">updateDeviceState</span><span class="token punctuation">(</span>deviceSwitchState<span class="token punctuation">)</span><span class="token punctuation">;</span>
	        	<span class="token punctuation">}</span>
	        	<span class="token keyword">break</span><span class="token punctuation">;</span>
	    	<span class="token comment">// ...</span>
    	<span class="token punctuation">}</span>
    	<span class="token function">statusUpdated</span><span class="token punctuation">(</span><span class="token class-name">ThingStatus</span><span class="token punctuation">.</span>ONLINE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">DeviceCommunicationException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// catch exceptions and handle it in your binding</span>
        <span class="token function">statusUpdated</span><span class="token punctuation">(</span><span class="token class-name">ThingStatus</span><span class="token punctuation">.</span>OFFLINE<span class="token punctuation">,</span> <span class="token class-name">ThingStatusDetail</span><span class="token punctuation">.</span>COMMUNICATION_ERROR<span class="token punctuation">,</span> ex<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="handling-refreshtype-command"><a href="#handling-refreshtype-command" aria-hidden="true" class="header-anchor">#</a> Handling RefreshType Command</h3> <p>If the framework requires the value of a channel, for example after bootup or because
a user-interface requested a refreshed value, if will send a <code>RefreshType</code> command.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleCommand</span><span class="token punctuation">(</span><span class="token class-name">ChannelUID</span> channelUID<span class="token punctuation">,</span> <span class="token class-name">Command</span> command<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>command <span class="token keyword">instanceof</span> <span class="token class-name">RefreshType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
        <span class="token function">updateWeatherData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>channelUID<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> CHANNEL_TEMPERATURE<span class="token operator">:</span>
                <span class="token function">updateState</span><span class="token punctuation">(</span>channelUID<span class="token punctuation">,</span> <span class="token function">getTemperature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> CHANNEL_HUMIDITY<span class="token operator">:</span>
                <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In this example, when a <code>RefreshType</code> command is sent to the <code>ThingHandler</code> it updates the weather data by executing an HTTP call in the <code>updateWeatherData</code> method and sends a state update via the <code>updateState</code> method.
This will update the state of the Item, which is linked to the channel for the given channel UID.</p> <h3 id="updating-the-channel-state"><a href="#updating-the-channel-state" aria-hidden="true" class="header-anchor">#</a> Updating the Channel State</h3> <p>State updates are sent from the binding to inform the framework, that the state of a channel has been updated.
For this the binding developer can call a method from the <code>BaseThingHandler</code> class like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token function">updateState</span><span class="token punctuation">(</span><span class="token string">&quot;channelId&quot;</span><span class="token punctuation">,</span> <span class="token class-name">OnOffType</span><span class="token punctuation">.</span>ON<span class="token punctuation">)</span>
</code></pre></div><p>The call will be delegated to the framework, which changes the state of all bound items.
It is binding specific when the channel should be updated.
If the device or service supports an event mechanism the ThingHandler should make use of it and update the state every time when the device changes its state.</p> <h3 id="polling-for-a-state"><a href="#polling-for-a-state" aria-hidden="true" class="header-anchor">#</a> Polling for a State</h3> <p>If no event mechanism is available, the binding can poll for the state.
The <code>BaseThingHandlerFactory</code> has an accessible <code>ScheduledExecutorService</code>, which can be used to schedule a job.
The following code block shows how to start a polling job in the initialize method of a <code>ThingHandler</code>, which runs with an interval of 30 seconds:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Runnable</span> runnable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// execute some binding specific polling code</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    pollingJob <span class="token operator">=</span> scheduler<span class="token punctuation">.</span><span class="token function">scheduleAtFixedDelay</span><span class="token punctuation">(</span>runnable<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Of course, the polling job must be cancelled in the dispose method:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pollingJob<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Even if the state has not changed since the last update, the binding should inform the framework, because it indicates that the value is still present.</p> <h3 id="trigger-a-channel"><a href="#trigger-a-channel" aria-hidden="true" class="header-anchor">#</a> Trigger a channel</h3> <p>The binding can inform the framework, that a channel has been triggered.
For this the binding developer can call a method from the BaseThingHandler class like this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token function">triggerChannel</span><span class="token punctuation">(</span><span class="token string">&quot;channelId&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>If an event payload is needed, use the overloaded version:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token function">triggerChannel</span><span class="token punctuation">(</span><span class="token string">&quot;channelId&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PRESSED&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>The call will be delegated to the framework.
It is binding specific when the channel should be triggered.</p> <h3 id="updating-the-thing-status"><a href="#updating-the-thing-status" aria-hidden="true" class="header-anchor">#</a> Updating the Thing Status</h3> <p>The <em>ThingHandler</em> must also manage the thing status (see also: <a href="/v2.5/docs/concepts/things.html#thing-status">Thing Status Concept</a>).
If the device or service is not working correctly, the binding should change the status to <em>OFFLINE</em> and back to <em>ONLINE</em>, if it is working again.
The status can be updated via an inherited method from the BaseThingHandler class by calling:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token function">updateStatus</span><span class="token punctuation">(</span><span class="token class-name">ThingStatus</span><span class="token punctuation">.</span>OFFLINE<span class="token punctuation">,</span> <span class="token class-name">ThingStatusDetail</span><span class="token punctuation">.</span>OFFLINE<span class="token punctuation">.</span>COMMUNICATION_ERROR<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The second argument of the method takes a <code>ThingStatusDetail</code> enumeration value, which further specifies the current status situation.
A complete list of all thing statuses and thing status details is listed in the <a href="/v2.5/docs/concepts/things.html#thing-status">Thing Status</a> chapter.</p> <p>The binding should also provide additional status description, if available.
This description might contain technical information (e.g. an HTTP status code, or any other protocol specific information, which helps to identify the current problem):</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token function">updateStatus</span><span class="token punctuation">(</span><span class="token class-name">ThingStatus</span><span class="token punctuation">.</span>OFFLINE<span class="token punctuation">,</span> <span class="token class-name">ThingStatusDetail</span><span class="token punctuation">.</span>OFFLINE<span class="token punctuation">.</span>COMMUNICATION_ERROR<span class="token punctuation">,</span> <span class="token string">&quot;HTTP 403 - Access denied&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>After the thing is created, the framework calls the <code>initialize</code> method of the handler.
At this time the state of the thing is <em>INTIALIZING</em> as long as the binding sets it to something else.
Because of this the default implementation of the <code>initialize()</code> method in the <code>BaseThingHandler</code> just changes the status to <em>ONLINE</em>.</p> <p><em>Note:</em> A binding should not set any other state than ONLINE, OFFLINE and UNKNOWN.
Additionally, REMOVED must be set after <code>handleRemoval()</code> has completed the removal process.
All other states are managed by the framework.</p> <p>Furthermore bindings can specify a localized description of the thing status by providing the reference of the localization string, e.g @text/rate_limit.
The corresponding handler is able to provide placeholder values as a JSON-serialized array of strings:</p> <div class="language- extra-class"><pre class="language-text"><code>&amp;#64;text/rate_limit [&quot;60&quot;, &quot;10&quot;, &quot;@text/hour&quot;]
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>rate_limit=Device is blocked by remote service for {0} minutes.
Maximum limit of {1} configuration changes per {2} has been exceeded.
For further info please refer to device vendor.
</code></pre></div><h3 id="channel-links"><a href="#channel-links" aria-hidden="true" class="header-anchor">#</a> Channel Links</h3> <p>Some bindings might want to start specific functionality for a channel only if an item is linked to the channel.
The <code>ThingHandler</code> has two callback methods <code>channelLinked(ChannelUID channelUID)</code> and <code>channelUnlinked(ChannelUID channelUID)</code>, which are called for every link that is added or removed to/from a channel.
So please be aware of the fact that both methods can be called multiple times.</p> <p>The <code>channelLinked</code> method is only called, if the thing handler has been initialized (status ONLINE/OFFLINE/UNKNOWN).
To actively check if a channel is linked, you can use the <code>isChannelLinked(ChannelUID channelUID)</code> method of the <code>ThingHandlerCallback</code>.</p> <h2 id="updating-the-thing-from-a-binding"><a href="#updating-the-thing-from-a-binding" aria-hidden="true" class="header-anchor">#</a> Updating the Thing from a Binding</h2> <p>It can happen that the binding wants to update the configuration or even the whole structure of a thing.
If the <code>BaseThingHandler</code> class is used, it provides some helper methods for modifying the thing.</p> <h3 id="updating-the-configuration"><a href="#updating-the-configuration" aria-hidden="true" class="header-anchor">#</a> Updating the Configuration</h3> <p>Usually the configuration is maintained by the user and the binding is informed about the updated configuration.
But if the configuration can also be changed in the external system, the binding should reflect this change and notify the framework about it.</p> <p>If the configuration should be updated, then the binding developer can retrieve a copy of the current configuration by calling <code>editConfiguration()</code>.
The updated configuration can be stored as a whole by calling <code>updateConfiguration(Configuration)</code>.</p> <p>Suppose that an external system causes an update of the configuration, which is read in as a <code>DeviceConfig</code> instance.
The following code shows how to update configuration:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">deviceConfigurationChanged</span><span class="token punctuation">(</span><span class="token class-name">DeviceConfig</span> deviceConfig<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Configuration</span> configuration <span class="token operator">=</span> <span class="token function">editConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    configuration<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;parameter1&quot;</span><span class="token punctuation">,</span> deviceConfig<span class="token punctuation">.</span><span class="token function">getValue1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    configuration<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;parameter2&quot;</span><span class="token punctuation">,</span> deviceConfig<span class="token punctuation">.</span><span class="token function">getValue2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">updateConfiguration</span><span class="token punctuation">(</span>configuration<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="updating-thing-properties"><a href="#updating-thing-properties" aria-hidden="true" class="header-anchor">#</a> Updating Thing Properties</h3> <p>Thing properties can be updated in the same way as the configuration.
The following example shows how to modify two properties of a thing:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">devicePropertiesChanged</span><span class="token punctuation">(</span><span class="token class-name">DeviceInfo</span> deviceInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> properties <span class="token operator">=</span> <span class="token function">editProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Thing</span><span class="token punctuation">.</span>PROPERTY_SERIAL_NUMBER<span class="token punctuation">,</span> deviceInfo<span class="token punctuation">.</span><span class="token function">getSerialNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Thing</span><span class="token punctuation">.</span>PROPERTY_FIRMWARE_VERSION<span class="token punctuation">,</span> deviceInfo<span class="token punctuation">.</span><span class="token function">getFirmwareVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">updateProperties</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If only one property must be changed, there is also a convenient method <code>updateProperty(String name, String value)</code>.
Both methods will only inform the framework that the thing was modified, if at least one property was added, removed or updated.</p> <p>Thing handler implementations must not rely on properties to be persisted as not all providers support that.</p> <h3 id="updating-the-thing-structure"><a href="#updating-the-thing-structure" aria-hidden="true" class="header-anchor">#</a> Updating the Thing Structure</h3> <p>The binding also has the possibility to change the thing structure by adding or removing channels.
The following code shows how to use the ThingBuilder to add one channel to the thing:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">thingStructureChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ThingBuilder</span> thingBuilder <span class="token operator">=</span> <span class="token function">editThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Channel</span> channel <span class="token operator">=</span> <span class="token class-name">ChannelBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ChannelUID</span><span class="token punctuation">(</span><span class="token string">&quot;bindingId:type:thingId:1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;String&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    thingBuilder<span class="token punctuation">.</span><span class="token function">withChannel</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">updateThing</span><span class="token punctuation">(</span>thingBuilder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="handling-thing-updates"><a href="#handling-thing-updates" aria-hidden="true" class="header-anchor">#</a> Handling Thing Updates</h3> <p>If the structure of a thing has been changed during runtime (after the thing was created), the binding is informed about this change in the ThingHandler within the <code>thingUpdated</code> method.
The <code>BaseThingHandler</code> has a default implementation for this method:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">thingUpdated</span><span class="token punctuation">(</span><span class="token class-name">Thing</span> thing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>thing <span class="token operator">=</span> thing<span class="token punctuation">;</span>
    <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If your binding contains resource-intensive logic in your initialize method, you should think of implementing the method by yourself and figuring out what is the best way to handle the change.</p> <p>For configuration updates, which are triggered from the binding, like in the previous three section,
the framework does not call the <code>thingUpdated</code> method to avoid infinite loops.</p> <h2 id="bridges"><a href="#bridges" aria-hidden="true" class="header-anchor">#</a> Bridges</h2> <p>In the domain of an IoT system there are often hierarchical structures of devices and services.
For example, one device acts as a gateway that enables communication with other devices that use the same protocol.
In openHAB this kind of device or service is called <em>Bridge</em>.
Philips Hue is one example of a system that requires a bridge.
The Hue gateway is an IP device with an HTTP API, which communicates over the ZigBee protocol with the Hue bulbs.
In the openHAB model the Hue gateway is represented as a <em>Bridge</em> with connected <em>Things</em>, that represent the Hue bulbs.
<em>Bridge</em> inherits from <em>Thing</em>, so that it also has <em>Channels</em> and all other features of a thing, with the addition that it also holds a list of things.</p> <p>We have a FAQ, dicussing <a href="/v2.5/docs/developer/bindings/faq.html#structuring-things-and-thing-types">Thing, Bridge and Channel modelling</a>.</p> <p>When implementing a binding with <em>Bridges</em>, the logic to communicate with the external system is often shared between the different <code>ThingHandler</code> implementations.
In that case it makes sense to implement a handler for the <em>Bridge</em> and delegate the actual command execution from the <em>ThingHandler</em> to the <em>BridgeHandler</em>.
To access the <em>BridgeHandler</em> from the <em>ThingHandler</em>, call <code>getBridge().getHandler()</code></p> <p>The following excerpt shows how the <code>HueLightHandler</code> delegates the command for changing the light state to the <code>HueBridgeHandler</code>:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleCommand</span><span class="token punctuation">(</span><span class="token class-name">ChannelUID</span> channelUID<span class="token punctuation">,</span> <span class="token class-name">Command</span> command<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token class-name">HueBridgeHandler</span> hueBridgeHandler <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HueBridgeHandler</span><span class="token punctuation">)</span> <span class="token function">getBridge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">switch</span> <span class="token punctuation">(</span>channelUID<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> CHANNEL_ID_COLOR_TEMPERATURE<span class="token operator">:</span>
            <span class="token class-name">StateUpdate</span> lightState <span class="token operator">=</span> lightStateConverter<span class="token punctuation">.</span><span class="token function">toColorLightState</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span>    
            hueBridgeHandler<span class="token punctuation">.</span><span class="token function">updateLightState</span><span class="token punctuation">(</span><span class="token function">getLight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lightState<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>    
        <span class="token keyword">case</span> CHANNEL_ID_COLOR<span class="token operator">:</span> 
            <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Inside the <code>BridgeHandler</code> the list of <em>Things</em> can be retrieved via the <code>getThings()</code> call.</p> <h3 id="bridge-handler-implementation"><a href="#bridge-handler-implementation" aria-hidden="true" class="header-anchor">#</a> Bridge Handler Implementation</h3> <p>A <code>BridgeHandler</code> handles the communication between the openHAB framework and a <em>bridge</em>  (a device that acts as a gateway to enable the communication with other devices) represented by a <code>Bridge</code> instance.</p> <p>A bridge handler has the same properties as thing handler.
Therefore, the <code>BridgeHandler</code> interface extends the <code>ThingHandler</code> interface.</p> <h3 id="the-basebridgehandler"><a href="#the-basebridgehandler" aria-hidden="true" class="header-anchor">#</a> The BaseBridgeHandler</h3> <p>openHAB provides an abstract implementation of the <code>BridgeHandler</code> interface named <code>BaseBridgeHandler</code>.
It is recommended to use this class, because it covers a lot of common logic.</p> <h3 id="life-cycle"><a href="#life-cycle" aria-hidden="true" class="header-anchor">#</a> Life cycle</h3> <p>A <code>BridgeHandler</code> has the same life cycle than a <code>ThingHandler</code> (created by a <code>ThingHandlerFactory</code>, well defined life cycle by handler methods <code>initialize()</code> and <code>dispose()</code>, see chapter <a href="/v2.5/docs/developer/bindings/thing-handler.html#life-cycle">Life Cycle</a>).
A bridge acts as a gateway in order to provide access to other devices, the <em>child things</em>.
Hence, the life cycle of a child handler depends on the life cycle of a bridge handler.
Bridge and child handlers are subject to the following restrictions:</p> <ul><li>A <code>BridgeHandler</code> of a bridge is initialized before <code>ThingHandler</code>s of its child things are initialized.</li> <li>A <code>BridgeHandler</code> is disposed after all <code>ThingHandler</code>s of its child things are disposed.</li></ul> <h3 id="handler-initialization-notification"><a href="#handler-initialization-notification" aria-hidden="true" class="header-anchor">#</a> Handler initialization notification</h3> <p>A <code>BridgeHandler</code> is notified about the initialization and disposal of child things.
Therefore, the <code>BridgeHandler</code> interface provides the two methods <code>childHandlerInitialized(ThingHandler, Thing)</code> and <code>childHandlerDisposed(ThingHandler, Thing)</code>.</p> <p>These methods can be used to allocate and deallocate resources for child things.</p> <h2 id="config-status-provider"><a href="#config-status-provider" aria-hidden="true" class="header-anchor">#</a> Config Status Provider</h2> <p>Each entity that has a configuration can provide its current configuration status to provide further information, especially in an error case.</p> <p>This information is available to user-interfaces to present configuration errors to the user.</p> <p>For this purpose the handler of the entity implements the interface <code>org.eclipse.smarthome.config.core.status.ConfigStatusProvider</code>.</p> <h3 id="providing-the-configuration-status"><a href="#providing-the-configuration-status" aria-hidden="true" class="header-anchor">#</a> Providing the Configuration Status</h3> <p>A <em>ThingHandler</em> as handler for the thing entity can provide the configuration status of the thing by implementing the <code>org.eclipse.smarthome.config.core.status.ConfigStatusProvider</code> interface.</p> <p>For things that are created by sub-classes of the <code>BaseThingHandlerFactory</code> the provider is already automatically registered as an OSGi service if the concrete thing handler implements the configuration status provider interface.
Currently the framework provides two base thing handler implementations for the configuration status provider interface:</p> <ul><li><code>org.eclipse.smarthome.core.thing.binding.ConfigStatusThingHandler</code> extends the <code>BaseThingHandler</code> and is to be used if the configuration status is to be provided for thing entities</li> <li><code>org.eclipse.smarthome.core.thing.binding.ConfigStatusBridgeHandler</code> extends the <code>BaseBridgeHandler</code> and is to be used if the configuration status is to be provided for bridge entities</li></ul> <p>Sub-classes of these handlers must only override the operation <code>getConfigStatus</code> to provide the configuration status in form of a collection of <code>org.eclipse.smarthome.config.core.status.ConfigStatusMessage</code>s.</p> <h4 id="internationalizing"><a href="#internationalizing" aria-hidden="true" class="header-anchor">#</a> Internationalizing</h4> <p>The framework will take care of internationalizing messagess.</p> <p>For this purpose there must be an i18n properties file inside the bundle of the configuration status provider that has a message declared for the message key of the <code>ConfigStatusMessage</code>.
The actual message key is built by the operation <code>withMessageKeySuffix(String)</code> of the message´s builder in the manner that the given message key suffix is appended to <em>config-status.&quot;config-status-message-type.&quot;</em>.</p> <p>As a result depending on the type of the message the final constructed message keys are:</p> <ul><li>config-status.information.any-suffix</li> <li>config-status.warning.any-suffix</li> <li>config-status.error.any-suffix</li> <li>config-status.pending.any-suffix</li></ul> <h2 id="handling-thing-bridge-removal"><a href="#handling-thing-bridge-removal" aria-hidden="true" class="header-anchor">#</a> Handling Thing / Bridge Removal</h2> <p>If a thing should be removed, the framework informs the binding about the removal request by calling <code>handleRemoval</code> at the thing/bridge handler.</p> <p>The thing will not be removed from the runtime until the binding confirms the deletion by setting the thing status to <code>REMOVED</code>.
If no special removal handling is required by the binding, you do not have to care about removal because the default implementation of this method in the <code>BaseThingHandler</code> class just calls <code>updateStatus(ThingStatus.REMOVED)</code>.</p> <p>However, for some radio-based devices it is needed to communicate with the device in order to unpair it safely.
After the device was successfully unpaired, the binding must inform the framework that the thing was removed by setting the thing status to <code>REMOVED</code>.</p> <p>After the removal was requested (i.e. the thing is in  <code>REMOVING</code> state), it cannot be changed back anymore to <code>ONLINE</code>/<code>OFFLINE</code>/<code>UNKNOWN</code> by the binding.
The binding may only initiate the status transition to <code>REMOVED</code>.</p> <h2 id="actions-bound-to-a-thing"><a href="#actions-bound-to-a-thing" aria-hidden="true" class="header-anchor">#</a> Actions bound to a Thing</h2> <p>Quite often the device or service you expose via openHAB Things allows certain actions to be performed.</p> <p>Examples are:</p> <ul><li>Reboot / Restart device</li> <li>Start searching for new lights for a Hue lights bridge</li> <li>Send message (via E-Mail / SMS Gateway service / Instant Messanger)</li></ul> <p>If you implement the <code>ThingActions</code> interface, you can tell the framework about your Thing related actions.</p> <p>Please note that for actions not related to Things you will instead implement an <code>ActionHandler</code> as described in the developing <a href="/v2.5/docs/developer/module-types/">Module Types</a> chapter.</p> <p>You start things off by implementing <code>ThingActions</code> and annotate your class with <code>@ThingActionsScope</code>:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ThingActionsScope</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;mqtt&quot;</span><span class="token punctuation">)</span> <span class="token comment">// Your bindings id is usually the scope</span>
<span class="token annotation punctuation">@NonNullByDefault</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MQTTActions</span> <span class="token keyword">implements</span> <span class="token class-name">ThingActions</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">AbstractBrokerHandler</span> handler<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setThingHandler</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ThingHandler</span> handler<span class="token punctuation">)</span> <span class="token punctuation">{</span> handler <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">AbstractBrokerHandler</span><span class="token punctuation">)</span> handler<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ThingHandler</span> <span class="token function">getThingHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> handler<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The second step is to return this class in your Thing handlers <code>getServices()</code> method:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyThingHandler</span> <span class="token keyword">extends</span> <span class="token class-name">BaseThingHandler</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">ThingHandlerService</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getServices</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token class-name">MQTTActions</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>As you can see in the above <code>MqttActions</code> implementation, the framework will call you back with the <code>ThingHandler</code>.</p> <p>You are now free to specify as many actions as you want in <code>MqttActions</code>.</p> <p>In the following example we provide a &quot;publishMQTT&quot; action.
An action must be annotated with <code>@RuleAction</code>, a label and a description must be provided.
In this case we refer to translation, see <a href="/v2.5/docs/developer/bindings/utils/i18n.html">i18n</a> support, instead of directly providing a string.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RuleAction</span><span class="token punctuation">(</span>label <span class="token operator">=</span> <span class="token string">&quot;@text/actionLabel&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;@text/actionDesc&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">publishMQTT</span><span class="token punctuation">(</span>
            <span class="token annotation punctuation">@ActionInput</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;topic&quot;</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">&quot;@text/actionInputTopicLabel&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;@text/actionInputTopicDesc&quot;</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> topic<span class="token punctuation">,</span>
            <span class="token annotation punctuation">@ActionInput</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">,</span> label <span class="token operator">=</span> <span class="token string">&quot;@text/actionInputValueLabel&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;@text/actionInputValueDesc&quot;</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">publishMQTT</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ThingActions</span> actions<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> topic<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>actions <span class="token keyword">instanceof</span> <span class="token class-name">MQTTActions</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">MQTTActions</span><span class="token punctuation">)</span> actions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">publishMQTT</span><span class="token punctuation">(</span>topic<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;Instance is not an MQTTActions class.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>Each member method also requires a static method with the same name.
This is to support the old DSL rules engine and make the action available there.</p> <p>Each parameter of an action member method must be annotated with <code>@ActionInput</code>.</p> <p>If you return values, you do so by returning a <code>Map&lt;String,Object&gt;</code> and annotate the method itself with as many <code>@ActionOutput</code>s as you will return map entries.</p> <h2 id="firmware-information-firmware-update"><a href="#firmware-information-firmware-update" aria-hidden="true" class="header-anchor">#</a> Firmware information / Firmware update</h2> <p>TODO</p> <h2 id="implementing-a-discovery-service"><a href="#implementing-a-discovery-service" aria-hidden="true" class="header-anchor">#</a> Implementing a Discovery Service</h2> <p>Bindings can implement the <code>DiscoveryService</code> interface and register it as an OSGi service to inform the framework about devices and services, that can be added as things to the system (see also <a href="/v2.5/docs/concepts/discovery.html">Inbox &amp; Discovery Concept</a>).</p> <p>A discovery service provides discovery results.
The following table gives an overview about the main parts of a <code>DiscoveryResult</code>:</p> <table><thead><tr><th>Field</th> <th>Description</th></tr></thead> <tbody><tr><td><code>thingUID</code></td> <td>The <code>thingUID</code> is the unique identifier of the specific discovered thing (e.g. a device's serial number). It  <em>must not</em> be constructed out of properties, that can change (e.g. IP addresses). A typical <code>thingUID</code> could look like this: <code>hue:bridge:001788141f1a</code></td></tr> <tr><td><code>thingTypeUID</code></td> <td>Contrary to the <code>thingUID</code> is the <code>thingTypeUID</code> that specifies the type the discovered thing belongs to. It could be constructed from e.g. a product number. A typical <code>thingTypeUID</code> could be the following: <code>hue:bridge</code>.</td></tr> <tr><td><code>bridgeUID</code></td> <td>If the discovered thing belongs to a bridge, the <code>bridgeUID</code> contains the UID of that bridge.</td></tr> <tr><td><code>properties</code></td> <td>The <code>properties</code> of a <code>DiscoveryResult</code> contain the configuration for the newly created thing.</td></tr> <tr><td><code>label</code></td> <td>The human readable representation of the discovery result. Do not put IP/MAC addresses or similar into the label but use the special <code>representationProperty</code> instead.</td></tr> <tr><td><code>representationProperty</code></td> <td>The name of one of the properties which discriminates the discovery result best against other results of the same type. Typically this is a serial number, IP or MAC address. The representationProperty often matches a configuration parameter and is also explicitly given in the thing-type definition.</td></tr></tbody></table> <p>To simplify the implementation of own discovery services, an abstract base class <code>AbstractDiscoveryService</code> implements the <code>DiscoveryService</code>, that must only be extended.
Subclasses of <code>AbstractDiscoveryService</code> do not need to handle the <code>DiscoveryListeners</code> themselves, they can use the methods <code>thingDiscovered</code> and <code>thingRemoved</code> to notify the registered listeners.
Most of the descriptions in this chapter refer to the <code>AbstractDiscoveryService</code>.</p> <p>For UPnP and mDNS there already are generic discovery services available.
Bindings only need to implement a <code>UpnpDiscoveryParticipant</code> resp. <code>mDNSDiscoveryParticipant</code>.
For details refer to the chapters <a href="#upnp-discovery">UPnP Discovery</a> and <a href="#mdns-discovery">mDNS Discovery</a>.</p> <p>The following example is taken from the <code>HueLightDiscoveryService</code>, it calls <code>thingDiscovered</code> for each found light.
It uses the <code>DiscoveryResultBuilder</code> to create the discovery result.</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">onLightAddedInternal</span><span class="token punctuation">(</span><span class="token class-name">FullLight</span> light<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThingUID</span> thingUID <span class="token operator">=</span> <span class="token function">getThingUID</span><span class="token punctuation">(</span>light<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>thingUID <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">ThingUID</span> bridgeUID <span class="token operator">=</span> hueBridgeHandler<span class="token punctuation">.</span><span class="token function">getThing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>LIGHT_ID<span class="token punctuation">,</span> light<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">DiscoveryResult</span> discoveryResult <span class="token operator">=</span> <span class="token class-name">DiscoveryResultBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>thingUID<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withProperties</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">withBridge</span><span class="token punctuation">(</span>bridgeUID<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withLabel</span><span class="token punctuation">(</span>light<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">thingDiscovered</span><span class="token punctuation">(</span>discoveryResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;discovered unsupported light of type '{}' with id {}&quot;</span><span class="token punctuation">,</span> light<span class="token punctuation">.</span><span class="token function">getModelID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> light<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>The discovery service needs to provide the list of supported thing types, that can be found by the discovery service.
This list will be given to the constructor of <code>AbstractDiscoveryService</code> and can be requested by using <code>DiscoveryService#getSupportedThingTypes</code> method.</p> <h3 id="registering-as-an-osgi-service"><a href="#registering-as-an-osgi-service" aria-hidden="true" class="header-anchor">#</a> Registering as an OSGi service</h3> <p>The <code>Discovery</code> class of a binding which implements <code>AbstractDiscoveryService</code> should be annotated with</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span><span class="token punctuation">(</span>service <span class="token operator">=</span> <span class="token class-name">DiscoveryService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> immediate <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> configurationPid <span class="token operator">=</span> <span class="token string">&quot;discovery.&lt;bindingID&gt;&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>where <code>&lt;bindingID&gt;</code> is the id of the binding, i.e. <code>astro</code> for the Astro binding.
Such a registered service will be picked up automatically by the framework.</p> <h3 id="background-discovery"><a href="#background-discovery" aria-hidden="true" class="header-anchor">#</a> Background Discovery</h3> <p>If the implemented discovery service enables background discovery, the <code>AbstractDiscoveryService</code> class automatically starts it.
If background discovery is enabled, the framework calls <code>AbstractDiscoveryService#startBackgroundDiscovery</code> when the binding is activated and <code>AbstractDiscoveryService#stopBackgroundDiscovery</code> when the component is deactivated.
The default implementations of both methods are empty and could be overridden by the binding developer.
Depending on the concrete implementation the discovery service might start and stop a scheduler in these method or register a listener for an external protocol.
The <code>thingDiscovered</code> method can be used to notify about a newly discovered thing.</p> <p>The following example shows the implementation of the above mentioned methods in the Wemo binding.</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">startBackgroundDiscovery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Start WeMo device background discovery&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>wemoDiscoveryJob <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> wemoDiscoveryJob<span class="token punctuation">.</span><span class="token function">isCancelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            wemoDiscoveryJob <span class="token operator">=</span> scheduler<span class="token punctuation">.</span><span class="token function">scheduleWithFixedDelay</span><span class="token punctuation">(</span>wemoDiscoveryRunnable<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> refreshInterval<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">stopBackgroundDiscovery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Stop WeMo device background discovery&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>wemoDiscoveryJob <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>wemoDiscoveryJob<span class="token punctuation">.</span><span class="token function">isCancelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            wemoDiscoveryJob<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            wemoDiscoveryJob <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="active-scan"><a href="#active-scan" aria-hidden="true" class="header-anchor">#</a> Active Scan</h3> <p>If the user triggers an active scan for a binding or specific set of thing types, the method <code>startScan</code> of each discovery service which supports these thing type is called.
Within these methods the things can be discovered.
The abstract base class automatically starts a thread, so the implementation of this method can be long-running.</p> <p>The following example implementation for <code>startScan</code> is taken from the <code>HueLightDiscoveryService</code>, that triggers a scan for known and also for new lights of the hue bridge.
Already discovered things are identified by the ThingUID the DiscoveryResult was created with, and won't appear in the inbox again.</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">startScan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FullLight</span><span class="token punctuation">&gt;</span></span> lights <span class="token operator">=</span> hueBridgeHandler<span class="token punctuation">.</span><span class="token function">getFullLights</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>lights <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">FullLight</span> l <span class="token operator">:</span> lights<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">onLightAddedInternal</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// search for unpaired lights</span>
        hueBridgeHandler<span class="token punctuation">.</span><span class="token function">startSearch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="re-discovered-results-and-things"><a href="#re-discovered-results-and-things" aria-hidden="true" class="header-anchor">#</a> Re-Discovered Results and Things</h3> <p>The <code>getThingUID</code> method of the discovery service should create a consistent UID every time the same thing gets discovered.
This way existing discovery results and existing things with this UID will be updated with the properties from the current scan.
With this, dynamic discoveries (like UPnP or mDNS) can re-discover existing things and update communication properties like host names or TCP ports.</p> <h3 id="remove-older-results"><a href="#remove-older-results" aria-hidden="true" class="header-anchor">#</a> Remove older results</h3> <p>Normally, older discovery results already in the inbox are left untouched by a newly triggered scan.
If this behavior is not appropriate for the implemented discovery service, one can override the method <code>stopScan</code> to call <code>removeOlderResults</code> as shown in the following example from the Hue binding:</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">stopScan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">stopScan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">removeOlderResults</span><span class="token punctuation">(</span><span class="token function">getTimestampOfLastScan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="upnp-discovery"><a href="#upnp-discovery" aria-hidden="true" class="header-anchor">#</a> UPnP Discovery</h3> <p>UPnP discovery is implemented in the framework as <code>UpnpDiscoveryService</code>.
It is widely used in bindings.
To facilitate the development, binding developers only need to implement a <code>UpnpDiscoveryParticipant</code>.
Here the developer only needs to implement three simple methods:</p> <ul><li><code>getSupportedThingTypeUIDs</code> - Returns the list of thing type UIDs that this participant supports.
The discovery service uses this method of all registered discovery participants to return the list of currently supported thing type UIDs.</li> <li><code>getThingUID</code> - Creates a thing UID out of the UPnP result or returns <code>null</code> if this is not possible.
This method is called from the discovery service during result creation to provide a unique thing UID for the result.</li> <li><code>createResult</code> - Creates the <code>DiscoveryResult</code> out of the UPnP result.
This method is called from the discovery service to create the actual discovery result.
It uses the <code>getThingUID</code> method to create the thing UID of the result.</li></ul> <p>The following example shows the implementation of the UPnP discovery participant for the Hue binding, the <code>HueBridgeDiscoveryParticipant</code>.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HueBridgeDiscoveryParticipant</span> <span class="token keyword">implements</span> <span class="token class-name">UpnpDiscoveryParticipant</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ThingTypeUID</span><span class="token punctuation">&gt;</span></span> <span class="token function">getSupportedThingTypeUIDs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singleton</span><span class="token punctuation">(</span>THING_TYPE_BRIDGE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">DiscoveryResult</span> <span class="token function">createResult</span><span class="token punctuation">(</span><span class="token class-name">RemoteDevice</span> device<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ThingUID</span> uid <span class="token operator">=</span> <span class="token function">getThingUID</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>uid <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>HOST<span class="token punctuation">,</span> device<span class="token punctuation">.</span><span class="token function">getDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBaseURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            properties<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>SERIAL_NUMBER<span class="token punctuation">,</span> device<span class="token punctuation">.</span><span class="token function">getDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSerialNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">DiscoveryResult</span> result <span class="token operator">=</span> <span class="token class-name">DiscoveryResultBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withProperties</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">withLabel</span><span class="token punctuation">(</span>device<span class="token punctuation">.</span><span class="token function">getDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFriendlyName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withRepresentationProperty</span><span class="token punctuation">(</span>SERIAL_NUMBER<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ThingUID</span> <span class="token function">getThingUID</span><span class="token punctuation">(</span><span class="token class-name">RemoteDevice</span> device<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DeviceDetails</span> details <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">getDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>details <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">ModelDetails</span> modelDetails <span class="token operator">=</span> details<span class="token punctuation">.</span><span class="token function">getModelDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>modelDetails <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> modelName <span class="token operator">=</span> modelDetails<span class="token punctuation">.</span><span class="token function">getModelName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>modelName <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>modelName<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;Philips hue bridge&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThingUID</span><span class="token punctuation">(</span>THING_TYPE_BRIDGE<span class="token punctuation">,</span> details<span class="token punctuation">.</span><span class="token function">getSerialNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="mdns-discovery"><a href="#mdns-discovery" aria-hidden="true" class="header-anchor">#</a> mDNS Discovery</h3> <p>mDNS discovery is implemented in the framework as <code>MDNSDiscoveryService</code>.
To facilitate the development, binding developers only need to implement a <code>MDNSDiscoveryParticipant</code>.
Here the developer only needs to implement four simple methods:</p> <ul><li><code>getServiceType</code> - Defines the <a href="http://www.dns-sd.org/ServiceTypes.html" target="_blank" rel="noopener noreferrer">mDNS service type<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li> <li><code>getSupportedThingTypeUIDs</code> - Returns the list of thing type UIDs that this participant supports.
The discovery service uses this method of all registered discovery participants to return the list of currently supported thing type UIDs.</li> <li><code>getThingUID</code> - Creates a thing UID out of the mDNS service info or returns <code>null</code> if this is not possible.
This method is called from the discovery service during result creation to provide a unique thing UID for the result.</li> <li><code>createResult</code> - Creates the <code>DiscoveryResult</code> out of the mDNS result.
This method is called from the discovery service to create the actual discovery result.
It uses the <code>getThingUID</code> method to create the thing UID of the result.</li></ul> <h3 id="discovery-that-is-bound-to-a-thing"><a href="#discovery-that-is-bound-to-a-thing" aria-hidden="true" class="header-anchor">#</a> Discovery that is bound to a Thing</h3> <p>TODO</p> <h2 id="frequently-asked-questions-faq"><a href="#frequently-asked-questions-faq" aria-hidden="true" class="header-anchor">#</a> Frequently asked questions / FAQ</h2> <p>Various binding related questions are answered in our <a href="/v2.5/docs/developer/bindings/faq.html">Binding development FAQ</a>.</p> <h2 id="include-the-binding-in-the-build"><a href="#include-the-binding-in-the-build" aria-hidden="true" class="header-anchor">#</a> Include the Binding in the Build</h2> <p>Once you are happy with your implementation, you need to integrate it in the Maven build and add it to the official distro.</p> <ul><li>Add a new line in the <a href="https://github.com/openhab/openhab2-addons/blob/master/bundles/pom.xml" target="_blank" rel="noopener noreferrer">bundle pom.xml<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li> <li>Add a new line in the <a href="https://github.com/openhab/openhab2-addons/blob/master/bom/openhab-addons/pom.xml" target="_blank" rel="noopener noreferrer">binding pom.xml<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li> <li>If you have a dependency on a transport bundle (e.g. upnp, mdns or serial) or an external library,
make sure to add a line for this dependency in the <code>/src/main/feature/feature.xml</code> file in your binding folder. See the other bindings as an example.</li> <li>Add your binding to the <a href="https://github.com/openhab/openhab2-addons/blob/master/CODEOWNERS" target="_blank" rel="noopener noreferrer">CODEOWNERS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> file so that you get notified by Github when someone adds a pull request towards your binding.</li></ul> <blockquote><p>Please make sure you add the above entries at their alphabetically correct position!</p></blockquote> <p>Before you create a pull request on GitHub, you should now run</p> <div class="language- extra-class"><pre class="language-text"><code>mvn clean install
</code></pre></div><p>from the repository root to ensure that the build works smoothly (that step takes about 30 minutes).</p> <p>The build includes <a href="https://github.com/openhab/static-code-analysis" target="_blank" rel="noopener noreferrer">Tooling for static code analysis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> that will validate your code against the openHAB Coding Guidelines and some additional best practices.
Please fix all the priority 1 issues and all issues with priority 2 and 3 that are relevant (if you have any doubt don't hesitate to ask).</p> <p>You can always run the above command from within your bindings directory to speed the build up and fix and check reported errors.</p> <p>Re-run the build to confirm that the checks are passing.
If it does, it is time to <a href="/v2.5/docs/developer/contributing/contributing.html">contribute your work</a>!</p> <div class="page-versions"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Version: 2.5</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><a href="https://www.openhab.org/docs/developer/bindings/">latest</a></li><li class="dropdown-item"><a class="current">2.5</a></li></ul></div></div> <div class="editLink"><em>Caught a mistake or want to contribute to the documentation? <a target="_blank" href="https://github.com/openhab/openhab-docs/edit/master/developers/bindings/index.md">Edit this page on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></em> <!----></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/v2.5/docs/developer/guidelines.html" class="prev">
          Coding Guidelines
        </a></span> <span class="next"><a href="/v2.5/docs/developer/module-types/">
          Automation Modules
        </a>
        →
      </span></p></div> <footer><div class="social-icons"><a href="https://twitter.com/openhab" target="_blank"><svg class="social-icon twitter"><path d="M32 7.075c-1.175 0.525-2.444 0.875-3.769 1.031 1.356-0.813 2.394-2.1 2.887-3.631-1.269 0.75-2.675 1.3-4.169 1.594-1.2-1.275-2.906-2.069-4.794-2.069-3.625 0-6.563 2.938-6.563 6.563 0 0.512 0.056 1.012 0.169 1.494-5.456-0.275-10.294-2.888-13.531-6.862-0.563 0.969-0.887 2.1-0.887 3.3 0 2.275 1.156 4.287 2.919 5.463-1.075-0.031-2.087-0.331-2.975-0.819 0 0.025 0 0.056 0 0.081 0 3.181 2.263 5.838 5.269 6.437-0.55 0.15-1.131 0.231-1.731 0.231-0.425 0-0.831-0.044-1.237-0.119 0.838 2.606 3.263 4.506 6.131 4.563-2.25 1.762-5.075 2.813-8.156 2.813-0.531 0-1.050-0.031-1.569-0.094 2.913 1.869 6.362 2.95 10.069 2.95 12.075 0 18.681-10.006 18.681-18.681 0-0.287-0.006-0.569-0.019-0.85 1.281-0.919 2.394-2.075 3.275-3.394z"></path></svg></a> <a href="https://github.com/openhab" target="_blank"><svg class="social-icon github"><path d="M10.369 24.837c0 0.125-0.144 0.225-0.325 0.225-0.206 0.019-0.35-0.081-0.35-0.225 0-0.125 0.144-0.225 0.325-0.225 0.188-0.019 0.35 0.081 0.35 0.225zM8.425 24.556c-0.044 0.125 0.081 0.269 0.269 0.306 0.162 0.063 0.35 0 0.387-0.125s-0.081-0.269-0.269-0.325c-0.162-0.044-0.344 0.019-0.387 0.144zM11.188 24.45c-0.181 0.044-0.306 0.163-0.287 0.306 0.019 0.125 0.181 0.206 0.369 0.163 0.181-0.044 0.306-0.163 0.287-0.288-0.019-0.119-0.188-0.2-0.369-0.181zM15.3 0.5c-8.669 0-15.3 6.581-15.3 15.25 0 6.931 4.362 12.863 10.594 14.95 0.8 0.144 1.081-0.35 1.081-0.756 0-0.387-0.019-2.525-0.019-3.837 0 0-4.375 0.938-5.294-1.863 0 0-0.713-1.819-1.737-2.288 0 0-1.431-0.981 0.1-0.962 0 0 1.556 0.125 2.412 1.613 1.369 2.413 3.662 1.719 4.556 1.306 0.144-1 0.55-1.694 1-2.106-3.494-0.387-7.019-0.894-7.019-6.906 0-1.719 0.475-2.581 1.475-3.681-0.162-0.406-0.694-2.081 0.162-4.244 1.306-0.406 4.313 1.688 4.313 1.688 1.25-0.35 2.594-0.531 3.925-0.531s2.675 0.181 3.925 0.531c0 0 3.006-2.1 4.313-1.688 0.856 2.169 0.325 3.838 0.163 4.244 1 1.106 1.613 1.969 1.613 3.681 0 6.031-3.681 6.512-7.175 6.906 0.575 0.494 1.063 1.431 1.063 2.9 0 2.106-0.019 4.712-0.019 5.225 0 0.406 0.288 0.9 1.081 0.756 6.25-2.075 10.488-8.006 10.488-14.938 0-8.669-7.031-15.25-15.7-15.25zM6.075 22.056c-0.081 0.063-0.063 0.206 0.044 0.325 0.1 0.1 0.244 0.144 0.325 0.063 0.081-0.063 0.063-0.206-0.044-0.325-0.1-0.1-0.244-0.144-0.325-0.063zM5.4 21.55c-0.044 0.081 0.019 0.181 0.144 0.244 0.1 0.063 0.225 0.044 0.269-0.044 0.044-0.081-0.019-0.181-0.144-0.244-0.125-0.038-0.225-0.019-0.269 0.044zM7.425 23.775c-0.1 0.081-0.063 0.269 0.081 0.387 0.144 0.144 0.325 0.163 0.406 0.063 0.081-0.081 0.044-0.269-0.081-0.387-0.138-0.144-0.325-0.163-0.406-0.063zM6.713 22.856c-0.1 0.063-0.1 0.225 0 0.369s0.269 0.206 0.35 0.144c0.1-0.081 0.1-0.244 0-0.387-0.088-0.144-0.25-0.206-0.35-0.125z"></path></svg></a> <a href="https://www.youtube.com/channel/UC7OK88DW0La_BJlcXZg8ydQ" target="_blank"><svg class="social-icon youtube"><path d="M31.681 9.6c0 0-0.313-2.206-1.275-3.175-1.219-1.275-2.581-1.281-3.206-1.356-4.475-0.325-11.194-0.325-11.194-0.325h-0.012c0 0-6.719 0-11.194 0.325-0.625 0.075-1.987 0.081-3.206 1.356-0.963 0.969-1.269 3.175-1.269 3.175s-0.319 2.588-0.319 5.181v2.425c0 2.587 0.319 5.181 0.319 5.181s0.313 2.206 1.269 3.175c1.219 1.275 2.819 1.231 3.531 1.369 2.563 0.244 10.881 0.319 10.881 0.319s6.725-0.012 11.2-0.331c0.625-0.075 1.988-0.081 3.206-1.356 0.962-0.969 1.275-3.175 1.275-3.175s0.319-2.587 0.319-5.181v-2.425c-0.006-2.588-0.325-5.181-0.325-5.181zM12.694 20.15v-8.994l8.644 4.513-8.644 4.481z"></path></svg></a></div> <div class="legal"><span class="copyright">Copyright © 2019 by the openHAB Community and the openHAB Foundation e.V.</span> <br> <span class="legal-links"><a href="/v2.5/privacy.html">Privacy policy</a> |
    <a href="/v2.5/imprint.html">Imprint</a></span></div> <img src="/openhab-logo-square.png" class="footer-logo"></footer></div> <!----></div></div>
    <script src="/v2.5/assets/js/app.6e1f6232.js" defer></script><script src="/v2.5/assets/js/26.3a17d104.js" defer></script><script src="/v2.5/assets/js/32.7c8f01a5.js" defer></script><script src="/v2.5/assets/js/33.df59480d.js" defer></script>
  </body>
</html>
